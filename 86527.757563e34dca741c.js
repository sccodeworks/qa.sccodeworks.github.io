"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[86527],{86527:(q,f,s)=>{s.r(f),s.d(f,{TallyMoveHistoryInquiryComponent:()=>mt});var T=s(15861),v=s(98739),l=s(7155),d=s(70879),g=s(77579),c=s(78372),p=s(71884),t=s(94650),u=s(24006),h=s(19132),_=s(11240),D=s(15627),S=s(36895),O=s(97392),A=s(28255),E=s(4859),Z=s(59549),U=s(44144),x=s(84385),P=s(3238),M=s(73546),b=s(10266),N=s(90455);function L(i,o){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16)(2,"div",47)(3,"span",48),t.NdJ("click",function(n){return n.stopPropagation()}),t.TgZ(4,"mat-slide-toggle",49),t.NdJ("ngModelChange",function(n){const m=t.CHM(e).$implicit;return t.KtG(m.isActive=n)})("change",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.toggleColumn(r))}),t._uU(5),t.qZA()()()(),t.BQk()}if(2&i){const e=o.$implicit;t.xp6(4),t.Q6J("ngModel",e.isActive),t.xp6(1),t.hij(" ",e.name," ")}}function R(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Move Number"),t.qZA())}function B(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HMTRAN)}}function w(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Item"),t.qZA())}function Y(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HMITEM)}}function z(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Lot"),t.qZA())}function W(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HLOTS)}}function Q(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Operator"),t.qZA())}function K(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HMUSER)}}function k(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Type"),t.qZA())}function J(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HMSTYP)}}function F(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Quantity"),t.qZA())}function $(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HQTY)}}function G(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Started"),t.qZA())}function j(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HMADAT)}}function X(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"From"),t.qZA())}function V(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HFRLOC)}}function tt(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"To"),t.qZA())}function et(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HTOLOC)}}function it(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Completed"),t.qZA())}function at(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HMCDAT)}}function ot(i,o){1&i&&(t.TgZ(0,"th",50),t._uU(1,"Status"),t.qZA())}function nt(i,o){if(1&i&&(t.TgZ(0,"td",51),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.HSTAT)}}function st(i,o){1&i&&t._UZ(0,"tr",52)}function rt(i,o){1&i&&t._UZ(0,"tr",53)}function lt(i,o){1&i&&(t.TgZ(0,"div",54),t._UZ(1,"img",55),t.TgZ(2,"h3",56),t._uU(3,"No Data Available"),t.qZA(),t.TgZ(4,"p",57),t._uU(5," There\u2019s no data to display right now. Try adjusting your filters or check back later. "),t.qZA()())}const ut=function(){return[8,16,24]};let mt=(()=>{class i{constructor(e,a,n,r){this.fb=e,this.router=a,this.storerService=n,this.iHeaderService=r,this.displayedColumns=["MoveNumber","Item","Lot","Operator","Type","Quantity"],this.user=localStorage.getItem("userName")||"",this.columnShowHideList=[],this.account="",this.sort="Move Number",this.pendingMoves="",this.completedMoves="",this.Stagedmoves="",this.document="",this.dataSource=new l.by,this.pageNumber=1,this.pageSize=8,this.totalRecords=0,this.storer="",this.searchInput$=new g.x,this.isSearchMode=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.isLoading=!0,this.noData=!1,this.form=this.fb.group({document1:this.document,sort1:this.sort}),this.prefixWithZeros=(m,C)=>String(m).padStart(C,"0"),this.tallyUrl="/main-nav/tallys/read"}ngOnInit(){this.element=history.state;const e=this.pageSize,a=this.pageNumber;this.searchInput$.pipe((0,c.b)(500),(0,p.x)()).subscribe(n=>{this.handleSearch(n)}),this.moveHistory(e,a),this.editedRows=[],this.initializeColumnProperties()}moveHistory(e,a){this.isLoading=!0,this.noData=!1,this.dataSource=new l.by([]),this.pageSize=e||this.pageSize,this.pageNumber=a||this.pageNumber,this.Subscription&&this.Subscription.unsubscribe(),this.Subscription=this.iHeaderService.tallyMoveHistoryInquiry(this.user,this.prefixWithZeros(this.element.IHTALY,9),this.sort,e,a).subscribe({next:n=>{this.isLoading=!1;var r=JSON.parse(n[0].data[1]?.value),m=r.returnedData||[];this.allData=m,this.filteredData=[...m],this.totalRecords=r.TotalRecords||m.length,this.pendingMoves=r.Pendingmoves,this.completedMoves=r.Completedmoves,this.Stagedmoves=r.Stagedmoves,this.document=r.Document,this.storer=this.element.IHSTOR+"\xa0"+r.StorerName,this.noData=0===m.length,this.dataSource.data=m,this.paginator&&(this.dataSource.paginator=this.paginator,this.paginator.length=this.totalRecords,this.paginator.pageIndex=(this.pageNumber||1)-1,this.paginator.pageSize=this.pageSize),this.noData?this.dataSource.data=[]:this.loadPage(this.pageNumber||1)},error:()=>this.handleMoveHistoryNoData()})}getMoveHistory(e){var a=this.form.value;a.sort1="Move Number"==a.sort1?"HMTRAN":"Completion Time"==a.sort1?"HMCDAT":"HMITEM",this.sort=a.sort1,this.moveHistory(this.pageSize,1)}toggleColumn(e){if(e.isActive)this.displayedColumns.includes(e.name)||this.displayedColumns.push(e.name);else{const a=this.displayedColumns.indexOf(e.name);a>-1&&this.displayedColumns.splice(a,1)}}initializeColumnProperties(){this.displayedColumns.forEach((e,a)=>{"Actions"!=e&&this.columnShowHideList.push({position:a,name:e,isActive:!0})}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Started",isActive:!1}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"From",isActive:!1}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"To",isActive:!1}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Completed",isActive:!1}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Status",isActive:!1})}ngOnDestroy(){this.Subscription&&this.Subscription.unsubscribe(),this.searchInput$.complete()}onPaginateChange(e){this.pageSize=e.pageSize,this.isSearchMode?this.loadPage(e.pageIndex+1):this.moveHistory(e.pageSize,e.pageIndex+1)}onBack(){this.router.navigate([this.tallyUrl])}applyGlobalFilterInput(e){this.searchInput$.next(e)}handleSearch(e){if(!(e=e.trim().toLowerCase()))return this.isSearchMode=!1,this.allData=[],this.filteredData=[],void this.moveHistory(this.pageSize,1);this.isSearchMode=!0,this.loadSearchChunks(e,()=>{if(0===this.filteredData.length)return this.noData=!0,void(this.dataSource.data=[]);this.noData=!1,this.loadPage(1)})}applyManualFilter(e){this.filteredData=this.allData.filter(a=>Object.values(a).some(n=>String(n).toLowerCase().includes(e))),this.noData=0===this.filteredData.length,this.totalRecords=this.filteredData.length,this.noData?this.dataSource.data=[]:this.loadPage(1)}loadPage(e){const a=(e-1)*this.pageSize;this.pageData=this.filteredData.slice(a,a+this.pageSize),this.dataSource.data=this.pageData,this.paginator&&(this.paginator.pageIndex=e-1,this.paginator.length=this.totalRecords,this.paginator.pageSize=this.pageSize)}getSearchStrategy(e){return e<=1500?{chunkSize:300,maxCalls:4}:e<=1e4?{chunkSize:2e3,maxCalls:5}:{chunkSize:5e3,maxCalls:5}}loadSearchChunks(e,a){var n=this;return(0,T.Z)(function*(){const{chunkSize:r,maxCalls:m}=n.getSearchStrategy(n.totalRecords||0);let C=1,I=0,y=[];for(;I<m;){const _t=(yield n.iHeaderService.tallyMoveHistoryInquiry(n.user,n.prefixWithZeros(n.element.IHTALY,9),n.sort,r,C).toPromise())?.[0]?.data?.[1]?.value||"{}",H=JSON.parse(_t)?.returnedData||[],ht=H.filter(ct=>Object.values(ct).some(pt=>String(pt).toLowerCase().includes(e)));if(y.push(...ht),y.length>0||H.length<r)break;C++,I++}n.allData=y,n.filteredData=y,n.totalRecords=y.length,a?.()})()}handleMoveHistoryNoData(){this.isLoading=!1,this.noData=!0,this.totalRecords=0,this.allData=[],this.filteredData=[],this.pageData=[],this.dataSource=new l.by([])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(u.qu),t.Y36(h.F0),t.Y36(_.h),t.Y36(D.X))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-tally-move-history-inquiry"]],viewQuery:function(e,a){if(1&e&&t.Gf(v.NW,5),2&e){let n;t.iGM(n=t.CRH())&&(a.paginator=n.first)}},standalone:!0,features:[t.jDz],decls:95,vars:16,consts:[[1,"over-Flow"],[1,"title"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"header-buttons"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Search",3,"input"],[1,"menu-container"],["mainMenuButton","matMenu"],[1,"grid-container"],[4,"ngFor","ngForOf"],["mat-button","","matTooltip","Hide/Show Columns",1,"mat-focus-indicator","addButton","mat-button","mat-button-base","tally-toltip-btn",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["src","assets/svg/header/showandhide.svg"],[1,"tally-serach-form"],[1,"form","over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width2"],["readonly","","matInput","",3,"value"],["appearance","outline",1,"full-width"],["readonly","","matInput","","formControlName","document1",3,"value"],["formControlName","sort1"],["default","","value","Move Number"],["value","Item Number"],["value","Completion Time"],[1,"footer"],["mat-raised-button","","type","submit","placeholder","Search",1,"buttons","addButton","new-tally-form-btn",3,"click"],["mat-table","","id","myTable",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","MoveNumber"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Item"],["matColumnDef","Lot"],["matColumnDef","Operator"],["matColumnDef","Type"],["matColumnDef","Quantity"],["matColumnDef","Started"],["matColumnDef","From"],["matColumnDef","To"],["matColumnDef","Completed"],["matColumnDef","Status"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data-container",4,"ngIf"],["showFirstLastButtons","",1,"tally-table-pagination",3,"length","pageSizeOptions","pageSize","page"],["paginator",""],[1,"grid-item"],[3,"click"],[3,"ngModel","ngModelChange","change"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"no-data-container"],["src","assets/svg/table-icons/file.svg",1,"mat-table-icon"],[1,"no-data-title"],[1,"no-data-message"]],template:function(e,a){if(1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"button",2),t.NdJ("click",function(){return a.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6," Inbound Move History Inquiry "),t.qZA(),t.TgZ(7,"div",3)(8,"mat-form-field",4)(9,"mat-icon",5),t._uU(10,"search"),t.qZA(),t.TgZ(11,"input",6),t.NdJ("input",function(r){return a.applyGlobalFilterInput(r.target.value)}),t.qZA()(),t.TgZ(12,"mat-menu",7,8)(14,"div",9),t.YNc(15,L,6,2,"ng-container",10),t.qZA()(),t.TgZ(16,"button",11,12),t._UZ(18,"img",13),t.qZA()()(),t.TgZ(19,"mat-card-content",14)(20,"form",15)(21,"div",16)(22,"div",17)(23,"mat-form-field",18)(24,"mat-label"),t._uU(25,"Account"),t.qZA(),t._UZ(26,"input",19),t.qZA(),t.TgZ(27,"mat-form-field",20)(28,"mat-label"),t._uU(29,"Document"),t.qZA(),t._UZ(30,"input",21),t.qZA(),t.TgZ(31,"mat-form-field",20)(32,"mat-label"),t._uU(33," Sort "),t.qZA(),t.TgZ(34,"mat-select",22)(35,"mat-option",23),t._uU(36,"Move Number"),t.qZA(),t.TgZ(37,"mat-option",24),t._uU(38,"Item Number"),t.qZA(),t.TgZ(39,"mat-option",25),t._uU(40,"Completion Time"),t.qZA()()(),t.TgZ(41,"mat-form-field",20)(42,"mat-label"),t._uU(43,"Pending Moves"),t.qZA(),t._UZ(44,"input",19),t.qZA(),t.TgZ(45,"mat-form-field",20)(46,"mat-label"),t._uU(47,"Staged Moves"),t.qZA(),t._UZ(48,"input",19),t.qZA(),t.TgZ(49,"mat-form-field",20)(50,"mat-label"),t._uU(51,"Completed Moves"),t.qZA(),t._UZ(52,"input",19),t.qZA()()(),t.TgZ(53,"div",26)(54,"button",27),t.NdJ("click",function(){return a.getMoveHistory(a.form.value)}),t._uU(55," Search "),t.qZA()()()(),t.TgZ(56,"table",28),t.ynx(57,29),t.YNc(58,R,2,0,"th",30),t.YNc(59,B,2,1,"td",31),t.BQk(),t.ynx(60,32),t.YNc(61,w,2,0,"th",30),t.YNc(62,Y,2,1,"td",31),t.BQk(),t.ynx(63,33),t.YNc(64,z,2,0,"th",30),t.YNc(65,W,2,1,"td",31),t.BQk(),t.ynx(66,34),t.YNc(67,Q,2,0,"th",30),t.YNc(68,K,2,1,"td",31),t.BQk(),t.ynx(69,35),t.YNc(70,k,2,0,"th",30),t.YNc(71,J,2,1,"td",31),t.BQk(),t.ynx(72,36),t.YNc(73,F,2,0,"th",30),t.YNc(74,$,2,1,"td",31),t.BQk(),t.ynx(75,37),t.YNc(76,G,2,0,"th",30),t.YNc(77,j,2,1,"td",31),t.BQk(),t.ynx(78,38),t.YNc(79,X,2,0,"th",30),t.YNc(80,V,2,1,"td",31),t.BQk(),t.ynx(81,39),t.YNc(82,tt,2,0,"th",30),t.YNc(83,et,2,1,"td",31),t.BQk(),t.ynx(84,40),t.YNc(85,it,2,0,"th",30),t.YNc(86,at,2,1,"td",31),t.BQk(),t.ynx(87,41),t.YNc(88,ot,2,0,"th",30),t.YNc(89,nt,2,1,"td",31),t.BQk(),t.YNc(90,st,1,0,"tr",42),t.YNc(91,rt,1,0,"tr",43),t.qZA(),t.YNc(92,lt,6,0,"div",44),t.TgZ(93,"mat-paginator",45,46),t.NdJ("page",function(r){return a.onPaginateChange(r)}),t.qZA()()),2&e){const n=t.MAs(13);t.xp6(15),t.Q6J("ngForOf",a.columnShowHideList),t.xp6(1),t.Q6J("matMenuTriggerFor",n),t.xp6(4),t.Q6J("formGroup",a.form),t.xp6(6),t.s9C("value",a.storer),t.xp6(4),t.s9C("value",a.document),t.xp6(14),t.s9C("value",a.pendingMoves),t.xp6(4),t.s9C("value",a.Stagedmoves),t.xp6(4),t.s9C("value",a.completedMoves),t.xp6(4),t.Q6J("dataSource",a.dataSource),t.xp6(34),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&a.noData),t.xp6(1),t.Q6J("length",a.totalRecords)("pageSizeOptions",t.DdM(15,ut))("pageSize",a.pageSize)}},dependencies:[d.m,S.sg,S.O5,u._Y,u.Fj,u.JJ,u.JL,u.On,u.sg,u.u,v.NW,O.Hw,A.VK,A.p6,E.lW,Z.KE,Z.hX,Z.qo,U.Nt,x.gD,P.ey,M.a8,M.dk,M.dn,M.n5,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,b.gM,N.Rr]}),i})()},15861:(q,f,s)=>{function T(l,d,g,c,p,t,u){try{var h=l[t](u),_=h.value}catch(D){return void g(D)}h.done?d(_):Promise.resolve(_).then(c,p)}function v(l){return function(){var d=this,g=arguments;return new Promise(function(c,p){var t=l.apply(d,g);function u(_){T(t,c,p,u,h,"next",_)}function h(_){T(t,c,p,u,h,"throw",_)}u(void 0)})}}s.d(f,{Z:()=>v})}}]);