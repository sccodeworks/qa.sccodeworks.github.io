"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[77012],{77012:(P,C,s)=>{s.r(C),s.d(C,{LpStagingComponent:()=>at});var D=s(15861),l=s(7155),c=s(70879),d=s(77579),f=s(78372),u=s(71884),t=s(94650),h=s(19132),p=s(15627),m=s(65412),r=s(24006),T=s(36895),v=s(98739),O=s(97392),E=s(28255),y=s(4859),Z=s(59549),U=s(44144),L=s(73546),x=s(10266),R=s(90455);const N=["paginator"];function B(e,o){if(1&e){const a=t.EpF();t.ynx(0),t.TgZ(1,"div",16)(2,"div",37)(3,"span",38),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(4,"mat-slide-toggle",39),t.NdJ("ngModelChange",function(i){const _=t.CHM(a).$implicit;return t.KtG(_.isActive=i)})("change",function(){const g=t.CHM(a).$implicit,_=t.oxw();return t.KtG(_.toggleColumn(g))}),t._uU(5),t.qZA()()()(),t.BQk()}if(2&e){const a=o.$implicit;t.xp6(4),t.Q6J("ngModel",a.isActive),t.xp6(1),t.hij(" ",a.name," ")}}function b(e,o){1&e&&(t.TgZ(0,"th",40),t._uU(1,"Serial Number"),t.qZA())}function w(e,o){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const a=o.$implicit;t.xp6(1),t.hij(" ",a.IDISRL," ")}}function z(e,o){1&e&&(t.TgZ(0,"th",40),t._uU(1,"Condition"),t.qZA())}function Y(e,o){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const a=o.$implicit;t.xp6(1),t.Oqu(a.IDISTA)}}function K(e,o){1&e&&(t.TgZ(0,"th",40),t._uU(1,"Quantity"),t.qZA())}function Q(e,o){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const a=o.$implicit;t.xp6(1),t.hij(" ",a.IDIQTY," ")}}function W(e,o){1&e&&(t.TgZ(0,"th",40),t._uU(1,"Status"),t.qZA())}function H(e,o){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const a=o.$implicit;t.xp6(1),t.hij(" ",a.IDISTS," ")}}function J(e,o){1&e&&(t.TgZ(0,"th",40),t._uU(1,"Location"),t.qZA())}function k(e,o){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const a=o.$implicit;t.xp6(1),t.hij(" ",a.IDILOC," ")}}function j(e,o){1&e&&(t.TgZ(0,"th",40),t._uU(1,"Item"),t.qZA())}function F(e,o){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const a=o.$implicit;t.xp6(1),t.hij(" ",a.IDIDSC," ")}}function $(e,o){1&e&&(t.TgZ(0,"th",40),t._uU(1,"Lots"),t.qZA())}function G(e,o){if(1&e&&(t.TgZ(0,"td",41),t._uU(1),t.qZA()),2&e){const a=o.$implicit;t.xp6(1),t.hij(" ",a.IDILOT," ")}}function q(e,o){1&e&&t._UZ(0,"tr",42)}function X(e,o){1&e&&t._UZ(0,"tr",43)}function V(e,o){1&e&&(t.TgZ(0,"div",44),t._UZ(1,"img",45),t.TgZ(2,"h3",46),t._uU(3,"No Data Available"),t.qZA(),t.TgZ(4,"p",47),t._uU(5," There\u2019s no data to display right now. Try adjusting your filters or check back later. "),t.qZA()())}const tt=function(){return[8,16,24]};let at=(()=>{class e{constructor(a,n,i,g,_){this.activeRouter=a,this.IheaderService=n,this.router=i,this.matDialog=g,this.fb=_,this.displayedColumns=["Serial","Condition","Quantity","Status","Location"],this.dataSource=new l.by,this.columnShowHideList=[],this.pageSize=8,this.totalRecords=0,this.pageNumber=1,this.searchInput$=new d.x,this.isSearchMode=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.isLoading=!0,this.noData=!1,this.user=localStorage.getItem("userName")||"",this.url="/main-nav/tallys/read"}toggleColumn(a){if(a.isActive)a.position>this.displayedColumns.length-1?this.displayedColumns.push(a.name):this.displayedColumns.splice(a.position,0,a.name);else{let n=this.displayedColumns.indexOf(a.name);n>-1&&this.displayedColumns.splice(n,1)}}ngOnInit(){this.element=history.state,this.form=this.fb.group({Tally:this.element.IHTALY,Status:this.element.IHRCPS}),this.initializeColumnProperties(),this.editedRows=[];const a=this.pageSize,n=this.pageNumber;this.searchInput$.pipe((0,f.b)(500),(0,u.x)()).subscribe(i=>{this.handleSearch(i)}),this.LPStaging(a,n)}initializeColumnProperties(){this.displayedColumns.forEach((a,n)=>{"Actions"!=a&&this.columnShowHideList.push({position:n,name:a,isActive:!0})}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Item",isActive:!1}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Lots",isActive:!1})}LPStaging(a,n){this.isLoading=!0,this.noData=!1,this.dataSource=new l.by([]),this.pageSize=a||this.pageSize,this.pageNumber=n||this.pageNumber,this.IheaderService.LPStaging(this.user,this.element.IHTALY,a,n).subscribe({next:i=>{this.isLoading=!1;var g=JSON.parse(i[0].data[1]?.value||"{}"),_=g.returnedData||[];this.allData=_,this.filteredData=[..._],this.totalRecords=g.TotalRecords||_.length,this.noData=0===_.length,this.dataSource.data=_,this.paginator&&(this.dataSource.paginator=this.paginator,this.paginator.length=this.totalRecords,this.paginator.pageIndex=(this.pageNumber||1)-1,this.paginator.pageSize=this.pageSize),this.noData?this.dataSource.data=[]:this.loadPage(this.pageNumber||1)},error:()=>this.handleLPStagingNoData()})}onPaginateChange(a){this.pageSize=a.pageSize,this.isSearchMode?this.loadPage(a.pageIndex+1):this.LPStaging(a.pageSize,a.pageIndex+1)}ngOnDestroy(){this.searchInput$.complete()}applyGlobalFilterInput(a){this.searchInput$.next(a)}handleSearch(a){if(!(a=a.trim().toLowerCase()))return this.isSearchMode=!1,this.allData=[],this.filteredData=[],void this.LPStaging(this.pageSize,1);this.isSearchMode=!0,this.loadSearchChunks(a,()=>{if(0===this.filteredData.length)return this.noData=!0,void(this.dataSource.data=[]);this.noData=!1,this.loadPage(1)})}applyManualFilter(a){this.filteredData=this.allData.filter(n=>Object.values(n).some(i=>String(i).toLowerCase().includes(a))),this.noData=0===this.filteredData.length,this.totalRecords=this.filteredData.length,this.noData?this.dataSource.data=[]:this.loadPage(1)}loadPage(a){const n=(a-1)*this.pageSize;this.pageData=this.filteredData.slice(n,n+this.pageSize),this.dataSource.data=this.pageData,this.paginator&&(this.paginator.pageIndex=a-1,this.paginator.length=this.totalRecords,this.paginator.pageSize=this.pageSize)}getSearchStrategy(a){return a<=1500?{chunkSize:300,maxCalls:4}:a<=1e4?{chunkSize:2e3,maxCalls:5}:{chunkSize:5e3,maxCalls:5}}loadSearchChunks(a,n){var i=this;return(0,D.Z)(function*(){const{chunkSize:g,maxCalls:_}=i.getSearchStrategy(i.totalRecords||0);let M=1,A=0,S=[];for(;A<_;){const et=yield i.IheaderService.LPStaging(i.user,i.element.IHTALY,g,M).toPromise(),I=JSON.parse(et[0].data[1]?.value||"{}")?.returnedData||[],nt=I.filter(it=>Object.values(it).some(ot=>String(ot).toLowerCase().includes(a)));if(S.push(...nt),S.length>0||I.length<g)break;M++,A++}i.allData=S,i.filteredData=S,i.totalRecords=S.length,n?.()})()}handleLPStagingNoData(){this.isLoading=!1,this.noData=!0,this.totalRecords=0,this.allData=[],this.filteredData=[],this.pageData=[],this.dataSource=new l.by([])}onBack(){this.router.navigate([this.url])}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(h.gz),t.Y36(p.X),t.Y36(h.F0),t.Y36(m.uw),t.Y36(r.qu))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-lp-staging"]],viewQuery:function(a,n){if(1&a&&t.Gf(N,5),2&a){let i;t.iGM(i=t.CRH())&&(n.paginator=i.first)}},standalone:!0,features:[t.jDz],decls:58,vars:11,consts:[[1,"over-Flow"],[1,"title"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"header-buttons"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Search",3,"input"],[1,"menu-container"],["mainMenuButton","matMenu"],[1,"grid-container"],[4,"ngFor","ngForOf"],["mat-button","","matTooltip","Hide/Show Columns",1,"mat-focus-indicator","addButton","mat-button","mat-button-base","tally-toltip-btn",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["src","assets/svg/header/showandhide.svg"],[1,"tally-serach-form"],[1,"form","over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width2"],["readonly","","matInput","","formControlName","Tally"],["appearance","outline",1,"full-width"],["readonly","","matInput","","formControlName","Status"],["mat-table","","id","myTable",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","Serial"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Condition"],["matColumnDef","Quantity"],["matColumnDef","Status"],["matColumnDef","Location"],["matColumnDef","Item"],["matColumnDef","Lots"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data-container",4,"ngIf"],["showFirstLastButtons","",1,"tally-table-pagination",3,"length","pageSizeOptions","pageSize","page"],["paginator",""],[1,"grid-item"],[3,"click"],[3,"ngModel","ngModelChange","change"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"no-data-container"],["src","assets/svg/table-icons/file.svg",1,"mat-table-icon"],[1,"no-data-title"],[1,"no-data-message"]],template:function(a,n){if(1&a&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"button",2),t.NdJ("click",function(){return n.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6," Serial Staging Inquiry"),t.qZA(),t.TgZ(7,"div",3)(8,"mat-form-field",4)(9,"mat-icon",5),t._uU(10,"search"),t.qZA(),t.TgZ(11,"input",6),t.NdJ("input",function(g){return n.applyGlobalFilterInput(g.target.value)}),t.qZA()(),t.TgZ(12,"mat-menu",7,8)(14,"div",9),t.YNc(15,B,6,2,"ng-container",10),t.qZA()(),t.TgZ(16,"button",11,12),t._UZ(18,"img",13),t.qZA()()(),t.TgZ(19,"mat-card-content",14)(20,"form",15)(21,"div",16)(22,"div",17)(23,"mat-form-field",18)(24,"mat-label"),t._uU(25,"Tally"),t.qZA(),t._UZ(26,"input",19),t.qZA(),t.TgZ(27,"mat-form-field",20)(28,"mat-label"),t._uU(29,"Status"),t.qZA(),t._UZ(30,"input",21),t.qZA()()()()(),t.TgZ(31,"table",22),t.ynx(32,23),t.YNc(33,b,2,0,"th",24),t.YNc(34,w,2,1,"td",25),t.BQk(),t.ynx(35,26),t.YNc(36,z,2,0,"th",24),t.YNc(37,Y,2,1,"td",25),t.BQk(),t.ynx(38,27),t.YNc(39,K,2,0,"th",24),t.YNc(40,Q,2,1,"td",25),t.ynx(41,28),t.YNc(42,W,2,0,"th",24),t.YNc(43,H,2,1,"td",25),t.BQk()(),t.ynx(44,29),t.YNc(45,J,2,0,"th",24),t.YNc(46,k,2,1,"td",25),t.BQk(),t.ynx(47,30),t.YNc(48,j,2,0,"th",24),t.YNc(49,F,2,1,"td",25),t.BQk(),t.ynx(50,31),t.YNc(51,$,2,0,"th",24),t.YNc(52,G,2,1,"td",25),t.BQk(),t.YNc(53,q,1,0,"tr",32),t.YNc(54,X,1,0,"tr",33),t.qZA(),t.YNc(55,V,6,0,"div",34),t.TgZ(56,"mat-paginator",35,36),t.NdJ("page",function(g){return n.onPaginateChange(g)}),t.qZA()()),2&a){const i=t.MAs(13);t.xp6(15),t.Q6J("ngForOf",n.columnShowHideList),t.xp6(1),t.Q6J("matMenuTriggerFor",i),t.xp6(4),t.Q6J("formGroup",n.form),t.xp6(11),t.Q6J("dataSource",n.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("ngIf",!n.isLoading&&n.noData),t.xp6(1),t.Q6J("length",n.totalRecords)("pageSizeOptions",t.DdM(10,tt))("pageSize",n.pageSize)}},dependencies:[c.m,T.sg,T.O5,r._Y,r.Fj,r.JJ,r.JL,r.On,r.sg,r.u,v.NW,O.Hw,E.VK,E.p6,y.lW,Z.KE,Z.hX,Z.qo,U.Nt,L.a8,L.dk,L.dn,L.n5,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,x.gM,R.Rr]}),e})()},15861:(P,C,s)=>{function D(c,d,f,u,t,h,p){try{var m=c[h](p),r=m.value}catch(T){return void f(T)}m.done?d(r):Promise.resolve(r).then(u,t)}function l(c){return function(){var d=this,f=arguments;return new Promise(function(u,t){var h=c.apply(d,f);function p(r){D(h,u,t,p,m,"next",r)}function m(r){D(h,u,t,p,m,"throw",r)}p(void 0)})}}s.d(C,{Z:()=>l})}}]);