"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[34938],{69501:(K,M,s)=>{s.d(M,{J:()=>E});var o=s(94650),f=s(24006),b=s(47957),_=s(59549),S=s(44144),y=s(69751),I=s(68675),N=s(54004),x=s(70879),D=s(36895),U=s(3238);function p(m,Z){if(1&m&&(o.TgZ(0,"mat-option",7),o._uU(1),o.qZA()),2&m){const n=Z.$implicit;o.Q6J("value",n),o.xp6(1),o.hij(" ",n.description," ")}}function W(m,Z){1&m&&(o.TgZ(0,"mat-option"),o._uU(1," No matching results "),o.qZA())}function t(m,Z){1&m&&(o.TgZ(0,"mat-error"),o._uU(1," This field is required. Please select an option. "),o.qZA())}function q(m,Z){1&m&&(o.TgZ(0,"mat-hint",8),o._uU(1," The option you entered is not valid. Please select one from the list. "),o.qZA())}let E=(()=>{class m{constructor(n){this.fb=n,this.options=[],this.value=null,this.placeholder="",this.id="",this.ngControl=null,this.label="",this.appearance="outline",this.isRequired=!1,this.selectionChange=new o.vpe,this.describedBy="",this.touched=!1,this.focused=!1,this.empty=!1,this.required=!1,this.disabled=!1,this.shouldLabelFloat=!1,this.formControlName="",this.errorState=!1,this.onChange=l=>{this.errorState=0===this._filter(this.control.value).length&&this.control.value.length>0},this.onTouched=()=>{},this.control=this.fb.control("",{validators:this.isRequired?[f.kI.required]:[]}),this.stateChanges=new y.y,this.filteredOptions=this.control.valueChanges.pipe((0,I.O)(""),(0,N.U)(l=>this._filter(l)))}onFocus(){(!this.control.value||"string"==typeof this.control.value&&""===this.control.value.trim())&&this.control.setValue("")}ngOnInit(){this.isRequired&&this.control.setValidators([f.kI.required]),this.control.updateValueAndValidity(),this.filteredOptions=this.control.valueChanges.pipe((0,I.O)(""),(0,N.U)(n=>this._filter(n)))}_filter(n){let l="";if("string"==typeof n)l=n.trim();else{if(!n||"object"!=typeof n)return this.options;l=n.value.toLowerCase()}if(""===l)return this.errorState=!1,this.options;const d=this.options.filter(C=>C.value.toLowerCase().includes(l)||C.description.toLowerCase().includes(l));return this.errorState=0===d.length&&l.length>0,d}writeValue(n){this.control.setValue(n&&"object"==typeof n?`${n.value} - ${n.description}`:"string"==typeof n?n:""),this.errorState=0===this._filter(this.control.value).length&&this.control.value.length>0}onOptionSelected(n){this.control.setValue(n);const[l,d]=n.description.split(" ");this.valueControlName.setValue(l),this.suffixControlName&&this.suffixControlName.setValue(d||""),this.onChange(n.value),this.selectionChange.emit(n.value),this.autocompleteTrigger.closePanel()}displayOptionText(n){return n?n.value:""}registerOnChange(n){this.onChange=n}registerOnTouched(n){this.onTouched=n}setDisabledState(n){this.disabled=n}setDescribedByIds(n){}onContainerClick(n){this.autocompleteTrigger&&this.autocompleteTrigger.openPanel()}markAsTouched(){this.touched||(this.touched=!0,this.onTouched())}}return m.\u0275fac=function(n){return new(n||m)(o.Y36(f.qu))},m.\u0275cmp=o.Xpm({type:m,selectors:[["app-dropdown"]],viewQuery:function(n,l){if(1&n&&o.Gf(b.ZL,7),2&n){let d;o.iGM(d=o.CRH())&&(l.autocompleteTrigger=d.first)}},hostVars:1,hostBindings:function(n,l){2&n&&o.uIk("aria-describedby",l.describedBy)},inputs:{options:"options",value:"value",placeholder:"placeholder",id:"id",ngControl:"ngControl",label:"label",appearance:"appearance",valueControlName:"valueControlName",suffixControlName:"suffixControlName",displayControlName:"displayControlName",isRequired:"isRequired"},outputs:{selectionChange:"selectionChange"},standalone:!0,features:[o._Bn([{provide:f.JU,multi:!0,useExisting:m},{provide:_.Eo,useExisting:m}],[{provide:f.gN,useExisting:f.sg}]),o.jDz],decls:12,vars:15,consts:[["appearance","outline",1,"full-width2"],["matInput","",3,"formControl","placeholder","matAutocomplete","focus","blur"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","hint-error","style","color: red; font-size:12px",4,"ngIf"],[3,"value"],[1,"hint-error",2,"color","red","font-size","12px"]],template:function(n,l){if(1&n&&(o.TgZ(0,"mat-form-field",0)(1,"mat-label"),o._uU(2),o.qZA(),o.TgZ(3,"input",1),o.NdJ("focus",function(){return l.onFocus(),l.autocompleteTrigger.openPanel()})("blur",function(){return l.onTouched()}),o.qZA(),o.TgZ(4,"mat-autocomplete",2,3),o.NdJ("optionSelected",function(C){return l.onOptionSelected(C.option.value)}),o.YNc(6,p,2,2,"mat-option",4),o.ALo(7,"async"),o.YNc(8,W,2,0,"mat-option",5),o.ALo(9,"async"),o.qZA(),o.YNc(10,t,2,0,"mat-error",5),o.YNc(11,q,2,0,"mat-hint",6),o.qZA()),2&n){const d=o.MAs(5);let C;o.ekj("mat-form-field-invalid",l.control.invalid&&l.control.touched||l.errorState),o.xp6(2),o.Oqu(l.label),o.xp6(1),o.Q6J("formControl",l.control)("placeholder",l.placeholder)("matAutocomplete",d),o.xp6(1),o.Q6J("displayWith",l.displayOptionText),o.xp6(2),o.Q6J("ngForOf",o.lcZ(7,11,l.filteredOptions)),o.xp6(2),o.Q6J("ngIf",0===(null==(C=o.lcZ(9,13,l.filteredOptions))?null:C.length)&&l.control.value),o.xp6(2),o.Q6J("ngIf",l.control.invalid&&l.control.touched),o.xp6(1),o.Q6J("ngIf",l.errorState)}},dependencies:[x.m,D.sg,D.O5,f.Fj,f.JJ,f.oH,_.TO,_.KE,_.bx,_.hX,S.Nt,U.ey,D.Ov,f.UX,b.Bb,b.XC,b.ZL,_.lN,S.c]}),m})()},34938:(K,M,s)=>{s.r(M),s.d(M,{CreateComponent:()=>pt});var o=s(24006),f=s(48529),b=s(35226),_=s.n(b),S=s(78372),y=s(71884),I=s(70879),N=s(86385),x=s(69501),D=s(15861),U=s(65412),p=s(7155),W=s(77579),t=s(94650),q=s(19132),E=s(15627),m=s(80529),Z=s(65105),n=s(36895),l=s(98739),d=s(97392),C=s(4859),R=s(59549),J=s(44144),v=s(73546),w=s(39505);const Y=["paginator"];function F(r,u){1&r&&(t.TgZ(0,"th",30),t._uU(1,"Consignee"),t.qZA())}function B(r,u){if(1&r&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&r){const e=u.$implicit;t.xp6(1),t.hij("",e.WKNSCD," ")}}function L(r,u){1&r&&(t.TgZ(0,"th",30),t._uU(1,"Name/Address"),t.qZA())}function z(r,u){if(1&r&&(t.TgZ(0,"td",31),t._uU(1),t._UZ(2,"br"),t._uU(3),t.qZA()),2&r){const e=u.$implicit;t.xp6(1),t.hij("",e.WNAME," "),t.xp6(2),t.HOy("",e.WKADD1," ",e.WKADD2," ",e.WKADD3," ",e.WKADD4," ")}}function Q(r,u){1&r&&(t.TgZ(0,"th",30),t._uU(1,"Pct"),t.qZA())}function k(r,u){if(1&r&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&r){const e=u.$implicit;t.xp6(1),t.Oqu(e.WPRCNT)}}function H(r,u){1&r&&t._UZ(0,"th",32)}function j(r,u){if(1&r){const e=t.EpF();t.TgZ(0,"td",31)(1,"div",33)(2,"button",34)(3,"button",35),t.NdJ("click",function(){const c=t.CHM(e).$implicit,g=t.oxw();return t.KtG(g.selectConsignee(c))}),t._uU(4),t.qZA()()()()}if(2&r){const e=u.$implicit;t.xp6(3),t.Q6J("disabled",e.isSelected),t.xp6(1),t.hij(" ",e.isSelected?"Selected Consignee":"Select Consignee","\n")}}function V(r,u){1&r&&t._UZ(0,"tr",36)}function $(r,u){1&r&&t._UZ(0,"tr",37)}function G(r,u){1&r&&(t.TgZ(0,"div",38),t._UZ(1,"img",39),t.TgZ(2,"h3",40),t._uU(3,"No Data Available"),t.qZA(),t.TgZ(4,"p",41),t._uU(5," There\u2019s no data to display right now. Try adjusting your filters or check back later. "),t.qZA()())}const X=function(){return[8,16,24]};let tt=(()=>{class r{constructor(e,a,i,c,g,h,T,A,O){this.router=e,this.IheaderService=a,this.fb=i,this.route=c,this.http=g,this.matDialog=h,this.OrderService=T,this.anyvariable=A,this.dialogRef=O,this.duplicateSource=[],this.dataSource=new p.by,this.headerActions=[],this.menuItems=[],this.filteredItems=[],this.remainingItems=[],this.searchDropdownText="",this.recentSearches=[],this.filteredRecentSearches=[],this.isLoading=!0,this.noData=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.searchInput$=new W.x,this.currentFilters=null,this.user=localStorage.getItem("userName")||"",this.pageSize=8,this.totalRecords=0,this.isSearchMode=!1,this.displayedColumns=["Consignee","NameAddress","Pct","Actions"],this.zipCodeOptions=[]}ngOnInit(){this.element=history.state,this.form=this.fb.group({WKZIP:"",WKNMBR:"",WKSTRET:"",WKTRM1:"",WKTRM2:"",WKPCT:"",WKNAME:""}),this.form.get("WKZIP")?.valueChanges.pipe((0,S.b)(1e3),(0,y.x)()).subscribe(e=>{e&&e.length>=3?this.fetchZipcode():this.zipCodeOptions=[]}),this.fetchZipcode(),this.getMatchInquiry(this.pageSize,1),this.searchInput$.pipe((0,S.b)(1e3),(0,y.x)()).subscribe(e=>{this.handleSearch(e)})}fetchZipcode(){this.zipCodeOptions=[],this.OrderService.getZipCodes().subscribe(e=>{for(const a of e)this.zipCodeOptions.push(`${a.ZIPCOD} - ${a.ZICITY}, ${a.ZISTAT}`)})}handleItemClick(e,a){this.executeAction(e,a),this.addToRecentSearches(e)}executeAction(e,a){"function"==typeof this[e.action]?this[e.action](a):console.warn("Action not implemented:",e.action)}handleRecentClick(e,a){this.searchDropdownText=e.label,this.onSearchChange(),"function"==typeof this[e.action]&&this[e.action](a),this.addToRecentSearches(e)}addToRecentSearches(e){this.recentSearches=this.recentSearches.filter(a=>a.label!==e.label),this.recentSearches.unshift(e),this.recentSearches.length>5&&this.recentSearches.pop(),localStorage.setItem("recentSearches",JSON.stringify(this.recentSearches.map(a=>a.label))),this.filteredRecentSearches=[...this.recentSearches]}clearRecentSearches(){this.recentSearches=[],this.filteredRecentSearches=[],localStorage.removeItem("recentSearches")}onSearchChange(){const e=(this.searchDropdownText||"").toLowerCase();this.filteredItems=this.menuItems.filter(a=>a.label.toLowerCase().includes(e)),this.filteredRecentSearches=e?[]:[...this.recentSearches]}applyGlobalFilterInput(e){this.searchInput$.next(e)}handleSearch(e){if(!(e=e.trim().toLowerCase()))return this.isSearchMode=!1,this.allData=[],this.filteredData=[],this.noData=!1,this.paginator&&this.paginator.firstPage(),void this.getMatchInquiry(this.pageSize,1);this.isSearchMode=!0,0!==this.allData.length?this.applyManualFilter(e):this.getAlladjustinvoice(()=>this.applyManualFilter(e))}applyManualFilter(e){this.filteredData=this.allData.filter(a=>Object.values(a).some(i=>String(i).toLowerCase().includes(e))),this.noData=0===this.filteredData.length,this.totalRecords=this.filteredData.length,this.noData?this.dataSource.data=[]:this.loadPage(1)}selectConsignee(e){this.dataSource.data.forEach(a=>{a.isSelected=!1}),e.isSelected=!0,this.dialogRef.close(e)}loadPage(e){const a=(e-1)*this.pageSize;this.pageData=this.filteredData.slice(a,a+this.pageSize),this.dataSource.data=this.pageData,this.paginator&&(this.paginator.pageIndex=e-1,this.paginator.length=this.totalRecords,this.paginator.pageSize=this.pageSize)}onSearchClick(){let e=this.form.get("WKZIP")?.value;e?.includes("-")&&(e=e.split("-")[0].trim(),this.form.get("WKZIP")?.setValue(e)),this.getMatchInquiry(this.pageSize,1)}onPaginateChange(e){this.pageSize=e.pageSize,this.isSearchMode?this.loadPage(e.pageIndex+1):this.getMatchInquiry(e.pageSize,e.pageIndex+1)}getAlladjustinvoice(e){var a=this;return(0,D.Z)(function*(){var i=a.form.value;if(a.allData.length>0)return void(e&&e());let c=1,g=1,h=[];do{const A=(yield a.IheaderService.getConsigneeMatchInquiry(a.user,i.WKZIP,i.WKNMBR,i.WKSTRET,i.WKTRM1,i.WKTRM2,i.WKPCT,i.WKNAME,8,c).toPromise())?.[0]?.data||[],O=A[A.length-1]?.value,P=JSON.parse(O);h.push(...P.returnedData),a.totalRecords=P.TotalRecords,g=Math.ceil(P.TotalRecords/8),c++}while(c<=g);a.allData=h,e&&e()})()}ngOnDestroy(){this.getAll2Subscription&&this.getAll2Subscription.unsubscribe()}getMatchInquiry(e,a){this.isLoading=!0,this.noData=!1,this.dataSource=new p.by([]);var i=this.form.value;this.getAll2Subscription&&this.getAll2Subscription.unsubscribe(),this.getAll2Subscription=this.IheaderService.getConsigneeMatchInquiry(this.user,i.WKZIP,i.WKNMBR,i.WKSTRET,i.WKTRM1,i.WKTRM2,i.WKPCT,i.WKNAME,e,a).subscribe({next:c=>{this.isLoading=!1;try{const h=JSON.parse(c[0].data[1].value),T=h?.returnedData||[];this.totalRecords=h?.TotalRecords||0,this.allData=[],this.filteredData=[],this.noData=0===T.length,this.dataSource.data=T,this.paginator&&(this.paginator.length=this.totalRecords)}catch(h){console.error("\u274c Parse error:",h),this.handleReceivableNoData()}},error:()=>this.handleReceivableNoData()})}handleReceivableNoData(){this.isLoading=!1,this.noData=!0,this.totalRecords=0,this.allData=[],this.filteredData=[],this.pageData=[],this.dataSource=new p.by([])}rowClick(e){this.selectedRow=e}onBack(){this.router.navigate(["/main-nav/tallys/add"])}closeDialog(){this.dialogRef.close()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(q.F0),t.Y36(E.X),t.Y36(o.qu),t.Y36(q.gz),t.Y36(m.eN),t.Y36(U.uw),t.Y36(Z.p),t.Y36(U.WI),t.Y36(U.so))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-consignee-match-inquiry"]],viewQuery:function(e,a){if(1&e&&t.Gf(Y,5),2&e){let i;t.iGM(i=t.CRH())&&(a.paginator=i.first)}},standalone:!0,features:[t.jDz],decls:58,vars:10,consts:[[1,"over-Flow-panel"],[1,"main-header-title"],["mat-icon-button","",1,"close-btn",3,"click"],[1,"tally-serach-form"],[1,"over-Flow",3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],["appearance","outline","formControlName","WKZIP","label","Zip code*","required","",3,"options"],["appearance","outline",1,"full-width"],["matInput","","formControlName","WKNMBR"],["matInput","","formControlName","WKSTRET"],["matInput","","formControlName","WKTRM1"],["matInput","","formControlName","WKTRM2"],["matInput","","formControlName","WKPCT"],["matInput","","formControlName","WKNAME"],[1,"footer"],["mat-raised-button","","type","submit","placeholder","Search",1,"buttons","addButton"],["id","myTable","mat-table","",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","Consignee"],["mat-header-cell","","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","NameAddress"],["matColumnDef","Pct"],["matColumnDef","Actions"],["mat-header-cell","","class","tally_actions_sec",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data-container",4,"ngIf"],["showFirstLastButtons","",1,"tally-table-pagination",3,"length","pageSizeOptions","pageSize","page"],["paginator",""],["mat-header-cell","","mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"tally_actions_sec"],[1,"dropdown","more_options_btn"],["type","button","id","dropdownMenuButton1","data-bs-toggle","dropdown","aria-expanded","false",1,"btn"],["mat-raised-button","",1,"save-btn",3,"disabled","click"],["mat-header-row",""],["mat-row",""],[1,"no-data-container"],["src","assets/svg/table-icons/file.svg",1,"mat-table-icon"],[1,"no-data-title"],[1,"no-data-message"]],template:function(e,a){1&e&&(t.TgZ(0,"mat-card",0)(1,"div",1)(2,"mat-card-header")(3,"mat-card-title"),t._uU(4,"Consignee Match Inquiry"),t.qZA()(),t.TgZ(5,"button",2),t.NdJ("click",function(){return a.closeDialog()}),t.TgZ(6,"mat-icon"),t._uU(7,"close"),t.qZA()()(),t.TgZ(8,"mat-card-content",3)(9,"form",4),t.NdJ("ngSubmit",function(){return a.onSearchClick()}),t.TgZ(10,"div",5)(11,"div",6),t._UZ(12,"custom-input-autocomplete",7),t.TgZ(13,"mat-form-field",8)(14,"mat-label"),t._uU(15,"Street number"),t.qZA(),t._UZ(16,"input",9),t.qZA(),t.TgZ(17,"mat-form-field",8)(18,"mat-label"),t._uU(19,"Street"),t.qZA(),t._UZ(20,"input",10),t.qZA(),t.TgZ(21,"mat-form-field",8)(22,"mat-label"),t._uU(23,"Terms"),t.qZA(),t._UZ(24,"input",11),t.qZA(),t.TgZ(25,"mat-form-field",8)(26,"mat-label"),t._uU(27,"Terms"),t.qZA(),t._UZ(28,"input",12),t.qZA(),t.TgZ(29,"mat-form-field",8)(30,"mat-label"),t._uU(31,"Cutoff Used"),t.qZA(),t._UZ(32,"input",13),t.qZA(),t.TgZ(33,"mat-form-field",8)(34,"mat-label"),t._uU(35,"Name"),t.qZA(),t._UZ(36,"input",14),t.qZA(),t.TgZ(37,"div",15)(38,"button",16),t._uU(39," Search "),t.qZA()()()()()(),t.TgZ(40,"table",17),t.ynx(41,18),t.YNc(42,F,2,0,"th",19),t.YNc(43,B,2,1,"td",20),t.BQk(),t.ynx(44,21),t.YNc(45,L,2,0,"th",19),t.YNc(46,z,4,5,"td",20),t.BQk(),t.ynx(47,22),t.YNc(48,Q,2,0,"th",19),t.YNc(49,k,2,1,"td",20),t.BQk(),t.ynx(50,23),t.YNc(51,H,1,0,"th",24),t.YNc(52,j,5,2,"td",20),t.BQk(),t.YNc(53,V,1,0,"tr",25),t.YNc(54,$,1,0,"tr",26),t.qZA(),t.YNc(55,G,6,0,"div",27),t.TgZ(56,"mat-paginator",28,29),t.NdJ("page",function(c){return a.onPaginateChange(c)}),t.qZA()()),2&e&&(t.xp6(9),t.Q6J("formGroup",a.form),t.xp6(3),t.Q6J("options",a.zipCodeOptions),t.xp6(28),t.Q6J("dataSource",a.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&a.noData),t.xp6(1),t.Q6J("length",a.totalRecords)("pageSizeOptions",t.DdM(9,X))("pageSize",a.pageSize))},dependencies:[I.m,n.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.sg,o.u,l.NW,d.Hw,C.lW,R.KE,R.hX,J.Nt,v.a8,v.dk,v.dn,v.n5,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,N.j,w.L]}),r})();var et=s(55847),ot=s(79979),at=s(84385),rt=s(3238);function it(r,u){1&r&&(t.TgZ(0,"div"),t._uU(1," Storer is required "),t.qZA())}function nt(r,u){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Received From is "),t.TgZ(2,"strong"),t._uU(3,"required"),t.qZA()())}function st(r,u){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Quantity is "),t.TgZ(2,"strong"),t._uU(3,"required"),t.qZA()())}function lt(r,u){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Only "),t.TgZ(2,"strong"),t._uU(3,"numbers"),t.qZA(),t._uU(4,"are allowed "),t.qZA())}function ut(r,u){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Only Alphabets and numbers are allowed "),t.qZA())}function ct(r,u){1&r&&(t.TgZ(0,"mat-error"),t._uU(1," Authorization must be less than 22 characters "),t.qZA())}function mt(r,u){if(1&r){const e=t.EpF();t.TgZ(0,"button",63),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addTally())}),t._uU(1," Create "),t.qZA()}}let pt=(()=>{class r{constructor(e,a,i,c,g,h){this.router=e,this.iHeaderSvc=a,this.fb=i,this.carrierSvc=c,this.matDialog=g,this.route=h,this.result=[],this.carrierOptions=[],this.update=!0,this.minDate=(new Date).toLocaleDateString("fr-CA"),this.StorerOptions=[],this.storerResult=[],this.carrierCodeOptions=[],this.zipCodeOptions=[],this.hasError=(T,A)=>this.form.controls[T].hasError(A)}ngOnInit(){localStorage.getItem("LoggedIn")?(this.user=localStorage.getItem("userName"),this.building=localStorage.getItem("building")):(this.user=f.R.user,this.building=f.R.building),this.form=this.fb.group({storer:["",[o.kI.required,o.kI.min(0),o.kI.pattern("[0-9]{1,10}")]],storerRef:[""],billTo:[""],billToSfx:[""],billToSfx2:[""],invoice:[""],building:[""],status:[""],loadType:["",[o.kI.required]],recptType:["",[o.kI.required]],recvdFrom:["",[o.kI.required]],qty:["",[o.kI.required,o.kI.min(0),o.kI.pattern("[0-9]{1,10}")]],schdldArrival:[""],carrier:[""],actualArrival:["",[o.kI.required]],schdldtime:[""],actualtime:[""],wgt:[""],pro:[""],car:[""],authorization:["",[o.kI.pattern(/^[A-Z0-9]{22}$/),o.kI.minLength(22),o.kI.maxLength(22)]],seal1:[""],seal2:[""],invoiceDate:["",[o.kI.required]],broken1:[""],broken2:[""],returnValue:[""],notification:[""],specialCharge:[""],chargeType:[""]}),this.carrierSvc.getAllCarriers(this.user,1,50).subscribe(e=>{this.result=e;var a=this.result[0].data[1]?.value,i=JSON.parse(a);this.carrierSource=i.returnedData,console.log("ALL CARRIERS DATA FOR ORDER UPDATE 2 DROPDOWN :"),console.log(this.carrierSource);for(const c of this.carrierSource)this.carrierOptions.push(c.CRNUMB)}),this.route.params.subscribe(e=>{this.tallyId=e.id}),this.tallyId?(this.update=!0,this.getAllSubscription=this.iHeaderSvc.getAll(this.user,this.building).subscribe(e=>{})):this.update=!1,this.form.get("storer")?.valueChanges.pipe((0,S.b)(1e3),(0,y.x)()).subscribe(e=>{if(!e)return this.StorerOptions=[],void this.form.get("storerRef")?.setValue("");if(e.length>=1&&!e.includes("-")&&this.loadStorers(),e.includes("-")){const a=e.split("-"),i=a[0].trim(),c=a.slice(1).join("-").trim();this.form.get("storer")?.setValue(i,{emitEvent:!1}),this.form.get("storerRef")?.setValue(c)}}),this.loadStorers(),this.fetchCarrierCode()}loadStorers(){this.StorerOptions=[],this.iHeaderSvc.getStorerAndSuffixCodes().subscribe(e=>{for(const a of e)this.StorerOptions.push(`${a.STORE} - ${a.STNAME}`)})}get typeloadStorers(){return this.form.controls.storer}fetchCarrierCode(){this.iHeaderSvc.getcarrierCode().subscribe(e=>{this.carrierCodeOptions=e.map(a=>({value:a.CRSCAC,description:`${a.CRSCAC} - ${a.CRNAME}`}))})}get typeCarrierCodeName(){return this.form.controls.carrier}ngOnDestroy(){this.getAllSubscription&&this.getAllSubscription.unsubscribe(),this.getTallyHeadersSubscription&&this.getTallyHeadersSubscription.unsubscribe()}addTally(){var e=this.form.value;e.returnValue=e.returnValue||"N",e.broken1=e.broken1||"N",e.broken2=e.broken2||"N",e.specialCharge=e.specialCharge||"N",e.loadType=null!=e.loadType?e.loadType.toUpperCase():null,e.recptType=null!=e.recptType?e.recptType.toUpperCase():null,e.recvdFrom=null!=e.recvdFrom?e.recvdFrom.toUpperCase():null,this.result=this.iHeaderSvc.createTally(e.storer,e.storerRef,e.status,e.loadType,e.recptType,e.recvdFrom,e.qty,e.schdldArrival,e.carrier?e.carrier.toUpperCase():"",e.actualArrival,e.building,e.pro?e.pro.toUpperCase():"",e.wgt,this.user,e.schdldtime,e.actualtime,e.authorization?e.authorization.toUpperCase():"",e.car?e.car.toUpperCase():"",e.seal1?e.seal1.toUpperCase():"",e.seal2?e.seal2.toUpperCase():"",e.invoiceDate,e.returnValue,e.broken1,e.broken2,e.specialCharge,e.notification,e.chargeType,e.billTo,e.billToSfx,e.billToSfx2).subscribe(a=>{if(this.result=a,console.log(this.result),JSON.parse(this.result[0].data[1].value),JSON.parse(this.result[0].data[1].value).success){const c=JSON.parse(this.result[0].data[1].value).returnedData.message;this.successMessage(c)}else{const c=JSON.parse(this.result[0].data[1].value).returnedData.message;this.failureMessage(c)}})}successMessage(e){_().fire(e,"","success").then(()=>{this.iHeaderSvc.getAll2(this.user,"","","","","","","","","","","",8,1).subscribe(a=>{try{const g=JSON.parse(a?.[0]?.data?.[1]?.value||"{}")?.returnedData||[];if(!g.length)return void console.error("No tally found");const h=g[0],T=h.IHTALY,A=h.IHSEQ,O={IHTALY:T,IHSEQ:A};console.log("Opening comments for:",T,A),this.matDialog.open(et.CommentsComponent,{panelClass:"right-dialog",data:O,autoFocus:!1})}catch(i){console.error("Parse error:",i)}})})}failureMessage(e){_().fire(e,"","error")}ConsigneeInquiry(e){this.matDialog.open(tt,{panelClass:"right-dialog",data:e,autoFocus:!1}).afterClosed().subscribe(i=>{i&&this.form.patchValue({recvdFrom:i.WKNSCD})})}onBack(){this.router.navigate(["/main-nav/tallys/read"])}fetchHeaders(){return this.getTallyHeadersSubscription&&this.getTallyHeadersSubscription.unsubscribe(),this.iHeaderSvc.getTallyHeaders().subscribe(e=>{})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(q.F0),t.Y36(E.X),t.Y36(o.qu),t.Y36(ot.C),t.Y36(U.uw),t.Y36(q.gz))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-create"]],standalone:!0,features:[t.jDz],decls:226,vars:13,consts:[[1,"over-Flow"],[1,"mat-card-head"],[1,"title"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"tally-serach-form","main-form"],[1,"form","over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["formControlName","storer","label","Storer","appearance","outline","required","",1,"full-width",3,"options"],[4,"ngIf"],["appearance","outline",1,"full-width"],["matInput","","formControlName","storerRef","readonly","",2,"text-transform","uppercase"],[1,"row-break"],["matInput","","formControlName","invoice","readonly",""],["matInput","","formControlName","building","readonly",""],["formControlName","status",3,"disabled"],["value",""],["value","I"],["value","A"],["value","P"],["value","S"],["value","W"],["value","D"],["value","C"],["value","N"],[1,"form-group1"],["for","inputField",1,"form-heading"],[1,"form-input"],["matInput","","formControlName","billTo"],["matInput","","formControlName","billToSfx",2,"text-transform","uppercase"],["matInput","","formControlName","billToSfx2",2,"text-transform","uppercase"],["formControlName","loadType"],["value","F"],["formControlName","recptType"],["value","L"],["value","O"],["value","T"],["matInput","","required","","formControlName","recvdFrom",2,"text-transform","uppercase",3,"click"],["matInput","","formControlName","qty"],["appearance","outline","formControlName","returnValue"],["value","Y"],["matInput","","formControlName","authorization",2,"text-transform","uppercase"],["matInput","","type","date","formControlName","schdldArrival"],["matInput","","type","time","formControlName","schdldtime"],["matInput","","type","date","formControlName","actualArrival","required",""],["matInput","","type","time","formControlName","actualtime","required",""],["matInput","","formControlName","pro",2,"text-transform","uppercase"],["appearance","outline","label","carrier","placeholder","Search or Enter carrier",3,"options","valueControlName","isRequired"],["matInput","","formControlName","car",2,"text-transform","uppercase"],["matInput","","formControlName","seal1",2,"text-transform","uppercase"],["formControlName","broken1"],["matInput","","formControlName","seal2",2,"text-transform","uppercase"],["formControlName","broken2"],["formControlName","notification"],["value","E"],["matInput","","type","date","formControlName","invoiceDate"],["formControlName","specialCharge"],["matInput","","formControlName","wgt"],["formControlName","chargeType"],["value","H"],[1,"footer"],["type","reset","mat-raised-button","",1,"buttons","cancel-btn"],["class","buttons addButton new-tally-form-btn","type","submit","mat-raised-button","",3,"click",4,"ngIf"],["type","submit","mat-raised-button","",1,"buttons","addButton","new-tally-form-btn",3,"click"]],template:function(e,a){if(1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header",1)(2,"mat-card-title",2)(3,"button",3),t.NdJ("click",function(){return a.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"arrow_back "),t.qZA()(),t._uU(6," Tally Create"),t.qZA()(),t.TgZ(7,"mat-card-content",4)(8,"form",5)(9,"div",6)(10,"div",7)(11,"custom-input-autocomplete",8),t.YNc(12,it,2,0,"div",9),t.qZA(),t.TgZ(13,"mat-form-field",10)(14,"mat-label"),t._uU(15," Storer Reference "),t.qZA(),t._UZ(16,"input",11),t.qZA(),t.TgZ(17,"div",12)(18,"mat-form-field",10)(19,"mat-label"),t._uU(20," Invoice "),t.qZA(),t._UZ(21,"input",13),t.qZA(),t.TgZ(22,"mat-form-field",10)(23,"mat-label"),t._uU(24," Building "),t.qZA(),t._UZ(25,"input",14),t.qZA(),t.TgZ(26,"mat-form-field",10)(27,"mat-label"),t._uU(28," Status "),t.qZA(),t.TgZ(29,"mat-select",15)(30,"mat-option",16),t._uU(31,"--select--"),t.qZA(),t.TgZ(32,"mat-option",17),t._uU(33," I - Intransit "),t.qZA(),t.TgZ(34,"mat-option",18),t._uU(35," A - Arrived (at dock) "),t.qZA(),t.TgZ(36,"mat-option",19),t._uU(37," P - Put Away "),t.qZA(),t.TgZ(38,"mat-option",20),t._uU(39," S - Submitted for W/R print "),t.qZA(),t.TgZ(40,"mat-option",21),t._uU(41," W - W/R printed "),t.qZA(),t.TgZ(42,"mat-option",22),t._uU(43," D - Deleted "),t.qZA(),t.TgZ(44,"mat-option",23),t._uU(45," C - Cancelled "),t.qZA(),t.TgZ(46,"mat-option",24),t._uU(47," N - Notified of Warehouse Receipt "),t.qZA()()()(),t.TgZ(48,"div",25)(49,"label",26),t._uU(50,"Bill To"),t.qZA(),t.TgZ(51,"div",27)(52,"mat-form-field",10)(53,"mat-label"),t._uU(54,"Bill To"),t.qZA(),t._UZ(55,"input",28),t.qZA(),t.TgZ(56,"mat-form-field",10)(57,"mat-label"),t._uU(58,"Suffix"),t.qZA(),t._UZ(59,"input",29),t.qZA(),t.TgZ(60,"mat-form-field",10)(61,"mat-label"),t._uU(62," Suffix 2"),t.qZA(),t._UZ(63,"input",30),t.qZA()()(),t.TgZ(64,"mat-form-field",10)(65,"mat-label"),t._uU(66,"Load Type "),t.qZA(),t.TgZ(67,"mat-select",31)(68,"mat-option",16),t._uU(69,"--select--"),t.qZA(),t.TgZ(70,"mat-option",20),t._uU(71,"S = Slip Sheet "),t.qZA(),t.TgZ(72,"mat-option",32),t._uU(73,"F = Floor unloaded "),t.qZA(),t.TgZ(74,"mat-option",23),t._uU(75,"C = Clamp "),t.qZA(),t.TgZ(76,"mat-option",19),t._uU(77,"P = Pallet "),t.qZA()()(),t.TgZ(78,"mat-form-field",10)(79,"mat-label"),t._uU(80,"Receipt Type "),t.qZA(),t.TgZ(81,"mat-select",33)(82,"mat-option",16),t._uU(83,"--select--"),t.qZA(),t.TgZ(84,"mat-option",34),t._uU(85," L = Less than truckload "),t.qZA(),t.TgZ(86,"mat-option",23),t._uU(87," C = Car load "),t.qZA(),t.TgZ(88,"mat-option",20),t._uU(89," S = 20 Ft. Container "),t.qZA(),t.TgZ(90,"mat-option",35),t._uU(91," O = Container "),t.qZA(),t.TgZ(92,"mat-option",19),t._uU(93," P = Pallet"),t.qZA(),t.TgZ(94,"mat-option",36),t._uU(95," T = Truckload"),t.qZA()()(),t.TgZ(96,"mat-form-field",10)(97,"mat-label"),t._uU(98,"Received From "),t.qZA(),t.TgZ(99,"input",37),t.NdJ("click",function(){return a.ConsigneeInquiry(a.element)}),t.qZA(),t.YNc(100,nt,4,0,"mat-error",9),t.qZA(),t.TgZ(101,"mat-form-field",10)(102,"mat-label"),t._uU(103,"Total Quantity "),t.qZA(),t._UZ(104,"input",38),t.YNc(105,st,4,0,"mat-error",9),t.YNc(106,lt,5,0,"mat-error",9),t.qZA(),t.TgZ(107,"mat-form-field",10)(108,"mat-label"),t._uU(109,"Returned"),t.qZA(),t.TgZ(110,"mat-select",39)(111,"mat-option",16),t._uU(112,"--select--"),t.qZA(),t.TgZ(113,"mat-option",40),t._uU(114,"Yes"),t.qZA(),t.TgZ(115,"mat-option",24),t._uU(116,"No"),t.qZA()()(),t.TgZ(117,"mat-form-field",10)(118,"mat-label"),t._uU(119,"Authorization "),t.qZA(),t._UZ(120,"input",41),t.YNc(121,ut,2,0,"mat-error",9),t.YNc(122,ct,2,0,"mat-error",9),t.qZA(),t.TgZ(123,"mat-form-field",10)(124,"mat-label"),t._uU(125,"Schedule Arrival date"),t.qZA(),t._UZ(126,"input",42),t.qZA(),t.TgZ(127,"mat-form-field",10)(128,"mat-label"),t._uU(129,"Schedule Arrival time"),t.qZA(),t._UZ(130,"input",43),t.qZA(),t.TgZ(131,"mat-form-field",10)(132,"mat-label"),t._uU(133,"Actual Arrival date"),t.qZA(),t._UZ(134,"input",44),t.qZA(),t.TgZ(135,"mat-form-field",10)(136,"mat-label"),t._uU(137,"Actual Arrival time"),t.qZA(),t._UZ(138,"input",45),t.qZA(),t.TgZ(139,"mat-form-field",10)(140,"mat-label"),t._uU(141,"Pro Number"),t.qZA(),t._UZ(142,"input",46),t.qZA(),t._UZ(143,"app-dropdown",47),t.TgZ(144,"mat-form-field",10)(145,"mat-label"),t._uU(146,"Car/Trailer No"),t.qZA(),t._UZ(147,"input",48),t.qZA(),t.TgZ(148,"div",12)(149,"mat-form-field",10)(150,"mat-label"),t._uU(151,"Seal 1"),t.qZA(),t._UZ(152,"input",49),t.qZA(),t.TgZ(153,"mat-form-field",10)(154,"mat-label"),t._uU(155,"Broken"),t.qZA(),t.TgZ(156,"mat-select",50)(157,"mat-option",16),t._uU(158,"--select--"),t.qZA(),t.TgZ(159,"mat-option",40),t._uU(160,"Yes"),t.qZA(),t.TgZ(161,"mat-option",24),t._uU(162,"No"),t.qZA()()()(),t.TgZ(163,"div",12)(164,"mat-form-field",10)(165,"mat-label"),t._uU(166,"Seal 2"),t.qZA(),t._UZ(167,"input",51),t.qZA(),t.TgZ(168,"mat-form-field",10)(169,"mat-label"),t._uU(170,"Broken"),t.qZA(),t.TgZ(171,"mat-select",52)(172,"mat-option",16),t._uU(173,"--select--"),t.qZA(),t.TgZ(174,"mat-option",40),t._uU(175,"Yes"),t.qZA(),t.TgZ(176,"mat-option",24),t._uU(177,"No"),t.qZA()()()(),t.TgZ(178,"mat-form-field",10)(179,"mat-label"),t._uU(180,"Notification"),t.qZA(),t.TgZ(181,"mat-select",53)(182,"mat-option",16),t._uU(183,"--select--"),t.qZA(),t.TgZ(184,"mat-option",22),t._uU(185," D - Receiving Documents exist"),t.qZA(),t.TgZ(186,"mat-option",54),t._uU(187," E - Electronic/EDI "),t.qZA(),t.TgZ(188,"mat-option",24),t._uU(189,"N - No notification was received"),t.qZA()()(),t.TgZ(190,"mat-form-field",10)(191,"mat-label"),t._uU(192,"Invoice Date"),t.qZA(),t._UZ(193,"input",55),t.qZA(),t.TgZ(194,"mat-form-field",10)(195,"mat-label"),t._uU(196,"Special Charge"),t.qZA(),t.TgZ(197,"mat-select",56)(198,"mat-option",16),t._uU(199,"--select--"),t.qZA(),t.TgZ(200,"mat-option",40),t._uU(201,"Yes"),t.qZA(),t.TgZ(202,"mat-option",24),t._uU(203,"No"),t.qZA()()(),t.TgZ(204,"mat-form-field",10)(205,"mat-label"),t._uU(206,"Override Weight"),t.qZA(),t._UZ(207,"input",57),t.qZA(),t.TgZ(208,"mat-form-field",10)(209,"mat-label"),t._uU(210," Charge Type "),t.qZA(),t.TgZ(211,"mat-select",58)(212,"mat-option",16),t._uU(213,"--select--"),t.qZA(),t.TgZ(214,"mat-option",24),t._uU(215,"N = No Charge W/R "),t.qZA(),t.TgZ(216,"mat-option",22),t._uU(217," D = Distribution Only W/R "),t.qZA(),t.TgZ(218,"mat-option",20),t._uU(219,"S = Storage Only W/R "),t.qZA(),t.TgZ(220,"mat-option",59),t._uU(221," H = Handling Only W/R "),t.qZA()()()()(),t.TgZ(222,"div",60)(223,"button",61),t._uU(224,"Cancel"),t.qZA(),t.YNc(225,mt,2,0,"button",62),t.qZA()()()()),2&e){let i;t.xp6(8),t.Q6J("formGroup",a.form),t.xp6(3),t.Q6J("options",a.StorerOptions),t.xp6(1),t.Q6J("ngIf",(null==(i=a.form.get("storer"))?null:i.touched)&&(null==(i=a.form.get("storer"))?null:i.hasError("required"))),t.xp6(17),t.Q6J("disabled",!0),t.xp6(71),t.Q6J("ngIf",a.form.controls.recvdFrom.hasError("required")),t.xp6(5),t.Q6J("ngIf",a.form.controls.storer.hasError("required")),t.xp6(1),t.Q6J("ngIf",a.form.controls.qty.hasError("pattern")),t.xp6(15),t.Q6J("ngIf",a.hasError("authorization","pattern")),t.xp6(1),t.Q6J("ngIf",a.hasError("authorization","minlength")||a.hasError("authorization","maxlength")),t.xp6(21),t.Q6J("options",a.carrierCodeOptions)("valueControlName",a.typeCarrierCodeName)("isRequired",!0),t.xp6(82),t.Q6J("ngIf",!a.update)}},dependencies:[I.m,n.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.sg,o.u,d.Hw,C.lW,R.TO,R.KE,R.hX,J.Nt,at.gD,rt.ey,v.a8,v.dk,v.dn,v.n5,N.j,w.L,x.J]}),r})()}}]);