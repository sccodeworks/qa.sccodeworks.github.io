"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[14146],{14146:(E,m,r)=>{r.r(m),r.d(m,{DriverOutWorkWithDockSchedulerComponent:()=>C});var _=r(35226),c=r.n(_),p=r(70879),D=r(86118),t=r(94650),f=r(72122),l=r(24006),O=r(19132),g=r(65412),v=r(97392),b=r(4859),d=r(59549),T=r(44144),u=r(73546);let C=(()=>{class n{constructor(e,a,o,s,i){this.WorkWithDockSchedulerService=e,this.fb=a,this.router=o,this.matDialog=s,this.cd=i,this.user=localStorage.getItem("userName")||"",this.pageSize=8,this.pageNumber=1,this.enableData=!1,this.scheduledDate="",this.appointmentType=" ",this.outputMsg="Update/change allowed",this.errorMsg="No update/change allowed",this.completeMsg="Call DSU804R to complete"}ngOnInit(){this.element=history.state,console.log(this.element),this.form=this.fb.group({appointmentNo:{value:this.element.DSAPPT,disabled:!0},building:{value:this.element.DSBLDG,disabled:!0},inOut:{value:this.element.DSINOU,disabled:!0},loadType:{value:this.element.DSLTYP,disabled:!0},scacCode:{value:this.element.DSSCAC,disabled:!0},checkOutDate:"",checkOutTime:""}),this.form.get("checkOutDate")?.disable(),this.form.get("checkOutTime")?.disable(),setTimeout(()=>{this.driverCheckOut(this.pageSize,this.pageNumber)},0)}ngOnDestroy(){this.driverOutSubscription&&this.driverOutSubscription.unsubscribe()}driverCheckOut(e,a){this.driverOutSubscription&&this.driverOutSubscription.unsubscribe(),this.driverOutSubscription=this.WorkWithDockSchedulerService.driverRead(this.user,this.element.DSAPPT,e,a).subscribe(o=>{const i=JSON.parse(o[0].data[1]?.value).returnedData;this.appointmentType=i[0].WATYPD,this.scheduledDate=i[0].WSAPDT;const A=i[0]?.WCTIME||"";this.form.patchValue({checkOutDate:this.formatDate(i[0]?.WCDATE||""),checkOutTime:A}),this.enableData=(i[0].DisplayMsg||"").trim().toUpperCase()===this.outputMsg.trim().toUpperCase(),this.enableData?(this.form.get("checkOutDate")?.enable(),this.form.get("checkOutTime")?.enable()):(this.form.get("checkOutDate")?.disable(),this.form.get("checkOutTime")?.disable()),this.cd.detectChanges()})}startTime(){if(this.form.invalid)return;const e=this.form.value,a=e.checkOutTime.replace(":","");this.driverOutSubscription&&this.driverOutSubscription.unsubscribe(),this.driverOutSubscription=this.WorkWithDockSchedulerService.driverUpdate(this.user,this.element.DSAPPT,e.checkOutDate,a).subscribe(o=>{const i=JSON.parse(o[0].data[o[0].data.length-1].value).returnedData.message;i.trim().toUpperCase()===this.completeMsg.trim().toUpperCase()?this.new():this.failureMessage(i),this.cd.detectChanges()})}new(){this.matDialog.open(D.O,{width:"1000px",maxHeight:"90vh",data:this.element,autoFocus:!1})}successMessage(e){c().fire(e,"","success")}failureMessage(e){c().fire(e,"","error")}formatDate(e){if(!e)return"";const[a,o,s]=e.split("/");return`${Number(s)<50?"20"+s:"19"+s}-${a.padStart(2,"0")}-${o.padStart(2,"0")}`}onBack(){this.router.navigateByUrl("/main-nav/WorkWithDockScheduler/read")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.A),t.Y36(l.qu),t.Y36(O.F0),t.Y36(g.uw),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-driver-out-work-with-dock-scheduler"]],standalone:!0,features:[t.jDz],decls:53,vars:8,consts:[[1,"over-Flow"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"tally-serach-form"],[1,"over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width"],["matInput","","formControlName","appointmentNo"],["matInput","","formControlName","building"],["matInput","","formControlName","inOut"],["matInput","","readonly","",3,"value"],["matInput","","formControlName","loadType"],["matInput","","formControlName","scacCode"],[1,"form-group1"],[1,"form-heading"],[1,"form-input"],["matInput","","formControlName","checkOutDate",3,"type","readonly"],["matInput","","formControlName","checkOutTime",3,"type","readonly"],["type","submit","mat-raised-button","",1,"buttons","addButton","new-tally-form-btn",3,"disabled","click"]],template:function(e,a){1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title")(3,"button",1),t.NdJ("click",function(){return a.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6,"Driver Check-Out"),t.qZA()(),t.TgZ(7,"mat-card-content",2)(8,"form",3)(9,"div",4)(10,"div",5)(11,"mat-form-field",6)(12,"mat-label"),t._uU(13," Appointment Number"),t.qZA(),t._UZ(14,"input",7),t.qZA(),t.TgZ(15,"mat-form-field",6)(16,"mat-label"),t._uU(17,"Building"),t.qZA(),t._UZ(18,"input",8),t.qZA(),t.TgZ(19,"mat-form-field",6)(20,"mat-label"),t._uU(21," In/Out "),t.qZA(),t._UZ(22,"input",9),t.qZA(),t.TgZ(23,"mat-form-field",6)(24,"mat-label"),t._uU(25," Appointment Type"),t.qZA(),t._UZ(26,"input",10),t.qZA(),t.TgZ(27,"mat-form-field",6)(28,"mat-label"),t._uU(29," Load Type"),t.qZA(),t._UZ(30,"input",11),t.qZA(),t.TgZ(31,"mat-form-field",6)(32,"mat-label"),t._uU(33,"SCAC Code "),t.qZA(),t._UZ(34,"input",12),t.qZA(),t.TgZ(35,"mat-form-field",6)(36,"mat-label"),t._uU(37,"Scheduled"),t.qZA(),t._UZ(38,"input",10),t.qZA(),t.TgZ(39,"div",13)(40,"label",14),t._uU(41,"Check-Out"),t.qZA(),t.TgZ(42,"div",15)(43,"mat-form-field",6)(44,"mat-label"),t._uU(45,"Date"),t.qZA(),t._UZ(46,"input",16),t.qZA(),t.TgZ(47,"mat-form-field",6)(48,"mat-label"),t._uU(49,"Time"),t.qZA(),t._UZ(50,"input",17),t.qZA()()(),t.TgZ(51,"button",18),t.NdJ("click",function(){return a.startTime()}),t._uU(52," Submit "),t.qZA()()()()()()),2&e&&(t.xp6(8),t.Q6J("formGroup",a.form),t.xp6(18),t.s9C("value",a.appointmentType),t.xp6(12),t.s9C("value",a.scheduledDate),t.xp6(8),t.Q6J("type",a.enableData?"date":"text")("readonly",!a.enableData),t.xp6(4),t.Q6J("type",a.enableData?"time":"text")("readonly",!a.enableData),t.xp6(1),t.Q6J("disabled",a.form.invalid||!a.enableData))},dependencies:[p.m,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,v.Hw,b.lW,d.KE,d.hX,T.Nt,u.a8,u.dk,u.dn,u.n5]}),n})()}}]);