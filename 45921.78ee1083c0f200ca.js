"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[45921],{45921:(Q,v,s)=>{s.r(v),s.d(v,{DetailsOperatorEquipmentComponent:()=>tt});var M=s(15861),O=s(70879),g=s(98739),h=s(7155),q=s(77579),E=s(78372),T=s(71884),t=s(94650),D=s(80529),r=s(65412),o=s(19132),l=s(24006),p=s(12412),c=s(36895),d=s(97392),_=s(28255),P=s(4859),C=s(59549),Z=s(44144),S=s(73546),x=s(10266),y=s(90455);function L(n,u){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16)(2,"div",42)(3,"span",43),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(4,"mat-slide-toggle",44),t.NdJ("ngModelChange",function(i){const f=t.CHM(e).$implicit;return t.KtG(f.isActive=i)})("change",function(){const m=t.CHM(e).$implicit,f=t.oxw();return t.KtG(f.toggleColumn(m))}),t._uU(5),t.qZA()()()(),t.BQk()}if(2&n){const e=u.$implicit;t.xp6(4),t.Q6J("ngModel",e.isActive),t.xp6(1),t.hij(" ",e.name," ")}}function w(n,u){1&n&&(t.TgZ(0,"th",45),t._uU(1,"Question Sentence"),t.qZA())}function W(n,u){if(1&n&&(t.TgZ(0,"td",46),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.xp6(1),t.Oqu(e["QDSEQ#"])}}function K(n,u){1&n&&(t.TgZ(0,"th",47),t._uU(1,"Question"),t.qZA())}function H(n,u){if(1&n&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.xp6(1),t.Oqu(e.QDQUES)}}function z(n,u){1&n&&(t.TgZ(0,"th",47),t._uU(1,"Equipment Check"),t.qZA())}function F(n,u){if(1&n&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.xp6(1),t.Oqu(e.QDANSW)}}function $(n,u){1&n&&(t.TgZ(0,"th",49),t._uU(1,"Status"),t.qZA())}function J(n,u){if(1&n&&(t.TgZ(0,"td",50)(1,"span",51),t._uU(2),t.qZA()()),2&n){const e=u.$implicit,a=t.oxw();t.xp6(1),t.Q6J("ngClass",a.getStatusClass(e.QDSTAT)),t.xp6(1),t.hij(" ",e.QDSTAT,"")}}function Y(n,u){1&n&&(t.TgZ(0,"th",47),t._uU(1,"Notes"),t.qZA())}function k(n,u){if(1&n&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.xp6(1),t.Oqu(e.QDNOTE)}}function j(n,u){1&n&&t._UZ(0,"tr",52)}function G(n,u){1&n&&t._UZ(0,"tr",53)}function X(n,u){1&n&&(t.TgZ(0,"div",54),t._UZ(1,"img",55),t.TgZ(2,"h3",56),t._uU(3,"No Data Available"),t.qZA(),t.TgZ(4,"p",57),t._uU(5," There\u2019s no data to display right now. Try adjusting your filters or check back later. "),t.qZA()())}const V=function(){return[8,16,24]};let tt=(()=>{class n{constructor(e,a,i,m,f){this.http=e,this.matDialog=a,this.router=i,this.fb=m,this.OperatorEquipmentSvc=f,this.user=localStorage.getItem("userName")||"",this.editedRows=[],this.dataSource=new h.by,this.searchTextDisplay=!1,this.pageSize=8,this.totalRecords=0,this.currentFilters=null,this.pageNumber=1,this.searchInput$=new q.x,this.isSearchMode=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.duplicateSource=[],this.headerActions=[],this.menuItems=[],this.filteredItems=[],this.remainingItems=[],this.searchDropdownText="",this.recentSearches=[],this.filteredRecentSearches=[],this.isLoading=!0,this.noData=!1,this.displayedColumns=["QuestionSentence","Question","EquipmentCheck","Status"],this.pagenumber=1,this.columnShowHideList=[]}ngOnInit(){const e=history.state;this.parentForm=e?.data?.[2],this.trans=e?.data?.[0]?.QHTRAN,console.log(e),this.form=this.fb.group({EquipmentNumber:e.data[0].QHEQUI,OperatorID:e.data[0].QHOPER,BuildingNumber:e.data[0].QHBLDG,EquipmentType:e.data[0].QHTYPE,DateTime:`${e.data[0].QDATE} ${e.data[0].QTIME.split(".").join(":")}`,Time:e.data[0].QTIME,Notes:e.data[0].QHNOTE,Transno:e.data[0].QHTRAN}),this.initializeColumnProperties(),this.editedRows=[];const a=this.pageSize,i=this.pageNumber;this.currentFilters=this.form.value,this.getEquipmentMaintQuesDetails(a,i),this.dataSource.filterPredicate=this.createFilter(),this.searchInput$.pipe((0,E.b)(500),(0,T.x)()).subscribe(m=>{this.handleSearch(m)})}applyGlobalFilterInput(e){this.searchInput$.next(e)}handleSearch(e){if(e=e.trim().toLowerCase(),this.currentFilters=this.form.value,!e)return this.isSearchMode=!1,this.noData=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.paginator&&(this.paginator.pageIndex=0),void this.getEquipmentMaintQuesDetails(this.pageSize,1);this.isSearchMode=!0,this.loadSearchChunks(e,()=>{if(0===this.filteredData.length)return this.noData=!0,void(this.dataSource.data=[]);this.noData=!1,this.loadPage(1)})}applyManualFilter(e){this.filteredData=this.allData.filter(a=>Object.values(a).some(i=>String(i).toLowerCase().includes(e))),this.noData=0===this.filteredData.length,this.totalRecords=this.filteredData.length,this.noData?this.dataSource.data=[]:this.loadPage(1)}loadPage(e){const a=(e-1)*this.pageSize;this.pageData=this.filteredData.slice(a,a+this.pageSize),this.dataSource.data=this.pageData,this.paginator&&(this.paginator.pageIndex=e-1,this.paginator.length=this.totalRecords,this.paginator.pageSize=this.pageSize)}onPaginateChange(e){this.pageSize=e.pageSize,this.isSearchMode?this.loadPage(e.pageIndex+1):this.getEquipmentMaintQuesDetails(e.pageSize,e.pageIndex+1)}getSearchStrategy(e){return e<=1500?{chunkSize:300,maxCalls:4}:e<=1e4?{chunkSize:2e3,maxCalls:5}:{chunkSize:5e3,maxCalls:5}}loadSearchChunks(e,a){var i=this;return(0,M.Z)(function*(){const m=i.currentFilters||{},{transno:f=i.trans}=m,I=i.totalRecords>0?i.totalRecords:1e4,{chunkSize:A,maxCalls:N}=i.getSearchStrategy(I);let U=1,b=0,R=[];for(;b<N;){const et=(yield i.OperatorEquipmentSvc.getOEquipmentMaintQuesHeaderDetails(i.user,f,A,U).toPromise())?.[0]?.data?.[1]?.value,B=JSON.parse(et||"{}")?.returnedData||[],at=B.filter(it=>Object.values(it).some(nt=>String(nt).toLowerCase().includes(e)));if(R.push(...at),B.length<A)break;U++,b++}i.allData=R,i.filteredData=R,i.totalRecords=R.length,a?.()})()}getStatusClass(e){return e?["C"].includes(e)?"status-gray":["W","SH","CD"].includes(e)?"status-green":["EN","I","N","RL"].includes(e)?"status-yellow":["A","PK","BL"].includes(e)?"status-purple":["PS","CM","MQ"].includes(e)?"status-blue":["EM","EP","SB","SP","EB","R","S","DL"].includes(e)?"status-red":"status-gray":""}handleItemClick(e,a){this.executeAction(e,a),this.addToRecentSearches(e)}executeAction(e,a){"function"==typeof this[e.action]?this[e.action](a):console.warn("Action not implemented:",e.action)}handleRecentClick(e,a){this.searchDropdownText=e.label,this.onSearchChange(),"function"==typeof this[e.action]&&this[e.action](a),this.addToRecentSearches(e)}addToRecentSearches(e){this.recentSearches=this.recentSearches.filter(a=>a.label!==e.label),this.recentSearches.unshift(e),this.recentSearches.length>5&&this.recentSearches.pop(),localStorage.setItem("recentSearches",JSON.stringify(this.recentSearches.map(a=>a.label))),this.filteredRecentSearches=[...this.recentSearches]}clearRecentSearches(){this.recentSearches=[],this.filteredRecentSearches=[],localStorage.removeItem("recentSearches")}onSearchChange(){const e=(this.searchDropdownText||"").toLowerCase();this.filteredItems=this.menuItems.filter(a=>a.label.toLowerCase().includes(e)),this.filteredRecentSearches=e?[]:[...this.recentSearches]}getBySearch(e){const a=this.pageSize,i=this.pageNumber;this.currentFilters=e,this.paginator&&this.paginator.firstPage(),this.getEquipmentMaintQuesDetails(a,i)}ngAfterViewInit(){this.dataSource.paginator=this.paginator}toggleColumn(e){if(e.isActive)this.displayedColumns.splice(e.position>this.displayedColumns.length-1?this.displayedColumns.length-1:e.position,0,e.name);else{let a=this.displayedColumns.indexOf(e.name);a>-1&&this.displayedColumns.splice(a,1)}console.log(this.displayedColumns)}initializeColumnProperties(){this.displayedColumns.forEach((e,a)=>{"Status"!=e&&"Notes"!=e&&this.columnShowHideList.push({position:a,name:e,isActive:!0})}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Notes",isActive:!1})}createFilter(){return(e,a)=>{const i=JSON.parse(a);return Object.keys(i).every(m=>e[m].toString().toLowerCase().includes(i[m].toLowerCase()))}}ngOnDestroy(){this.getAll2Subscription&&this.getAll2Subscription.unsubscribe()}searchEquipmentException(){this.searchTextDisplay=1!=this.searchTextDisplay}getEquipmentMaintQuesDetails(e,a){const i=history.state,f=this.currentFilters||{},{transno:I=i.data[0].QHTRAN}=f;this.getAll2Subscription&&this.getAll2Subscription.unsubscribe(),this.getAll2Subscription=this.OperatorEquipmentSvc.getOEquipmentMaintQuesHeaderDetails(this.user,I,e,a).subscribe(A=>{console.log(A);var N=JSON.parse(A[0].data[1]?.value);this.dataSource.data=N.returnedData,this.totalRecords=N.TotalRecords})}resetSearch(){this.form.reset();const e=this.pageSize,a=this.pageNumber;this.currentFilters=null,this.paginator.firstPage(),this.getEquipmentMaintQuesDetails(e,a)}onBack(){this.router.navigateByUrl("/main-nav/EquipMaintQuesHeader/read",{state:{returnedData:[this.parentForm]}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(D.eN),t.Y36(r.uw),t.Y36(o.F0),t.Y36(l.qu),t.Y36(p.b))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-details-operator-equipment"]],viewQuery:function(e,a){if(1&e&&t.Gf(g.NW,5),2&e){let i;t.iGM(i=t.CRH())&&(a.paginator=i.first)}},standalone:!0,features:[t.jDz],decls:68,vars:10,consts:[[1,"over-Flow"],[1,"title"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"header-buttons"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Search",3,"input"],[1,"menu-container"],["mainMenuButton","matMenu"],[1,"grid-container"],[4,"ngFor","ngForOf"],["mat-button","","matTooltip","Hide/Show Columns",1,"mat-focus-indicator","addButton","mat-button","mat-button-base","tally-toltip-btn",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["src","assets/svg/header/showandhide.svg"],[1,"tally-serach-form"],[1,"form","over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width"],["matInput","","formControlName","EquipmentNumber",2,"text-transform","uppercase"],["matInput","","formControlName","OperatorID",2,"text-transform","uppercase"],["matInput","","formControlName","BuildingNumber",2,"text-transform","uppercase"],["matInput","","formControlName","EquipmentType",2,"text-transform","uppercase"],["matInput","","formControlName","DateTime",2,"text-transform","uppercase"],["matInput","","formControlName","Notes",2,"text-transform","uppercase"],["mat-table","",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","QuestionSentence"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","Primary-row",4,"matCellDef"],["matColumnDef","Question"],["mat-header-cell","","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","EquipmentCheck"],["matColumnDef","Status"],["mat-header-cell","","class","status-cell",4,"matHeaderCellDef"],["mat-cell","","class","status-cell",4,"matCellDef"],["matColumnDef","Notes"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data-container",4,"ngIf"],["showFirstLastButtons","",3,"pageSize","pageSizeOptions","page"],["paginator",""],[1,"grid-item"],[3,"click"],[3,"ngModel","ngModelChange","change"],["mat-header-cell",""],["mat-cell","",1,"Primary-row"],["mat-header-cell","","mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"status-cell"],["mat-cell","",1,"status-cell"],[1,"status-badge",3,"ngClass"],["mat-header-row",""],["mat-row",""],[1,"no-data-container"],["src","assets/svg/table-icons/file.svg",1,"mat-table-icon"],[1,"no-data-title"],[1,"no-data-message"]],template:function(e,a){if(1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"button",2),t.NdJ("click",function(){return a.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6," Work With Equipment Maint Questions Detail"),t.qZA(),t.TgZ(7,"div",3)(8,"mat-form-field",4)(9,"mat-icon",5),t._uU(10,"search"),t.qZA(),t.TgZ(11,"input",6),t.NdJ("input",function(m){return a.applyGlobalFilterInput(m.target.value)}),t.qZA()(),t.TgZ(12,"mat-menu",7,8)(14,"div",9),t.YNc(15,L,6,2,"ng-container",10),t.qZA()(),t.TgZ(16,"button",11,12),t._UZ(18,"img",13),t.qZA()()(),t.TgZ(19,"mat-card-content",14)(20,"form",15)(21,"div",16)(22,"div",17)(23,"mat-form-field",18)(24,"mat-label"),t._uU(25,"Equipment Number"),t.qZA(),t._UZ(26,"input",19),t.qZA(),t.TgZ(27,"mat-form-field",18)(28,"mat-label"),t._uU(29,"Operator ID"),t.qZA(),t._UZ(30,"input",20),t.qZA(),t.TgZ(31,"mat-form-field",18)(32,"mat-label"),t._uU(33,"Building Number"),t.qZA(),t._UZ(34,"input",21),t.qZA(),t.TgZ(35,"mat-form-field",18)(36,"mat-label"),t._uU(37,"Equipment Type"),t.qZA(),t._UZ(38,"input",22),t.qZA(),t.TgZ(39,"mat-form-field",18)(40,"mat-label"),t._uU(41,"Date/Time"),t.qZA(),t._UZ(42,"input",23),t.qZA(),t.TgZ(43,"mat-form-field",18)(44,"mat-label"),t._uU(45,"Notes"),t.qZA(),t._UZ(46,"input",24),t.qZA()()()()(),t.TgZ(47,"table",25),t.ynx(48,26),t.YNc(49,w,2,0,"th",27),t.YNc(50,W,2,1,"td",28),t.BQk(),t.ynx(51,29),t.YNc(52,K,2,0,"th",30),t.YNc(53,H,2,1,"td",31),t.BQk(),t.ynx(54,32),t.YNc(55,z,2,0,"th",30),t.YNc(56,F,2,1,"td",31),t.BQk(),t.ynx(57,33),t.YNc(58,$,2,0,"th",34),t.YNc(59,J,3,2,"td",35),t.BQk(),t.ynx(60,36),t.YNc(61,Y,2,0,"th",30),t.YNc(62,k,2,1,"td",31),t.BQk(),t.YNc(63,j,1,0,"tr",37),t.YNc(64,G,1,0,"tr",38),t.qZA(),t.YNc(65,X,6,0,"div",39),t.TgZ(66,"mat-paginator",40,41),t.NdJ("page",function(m){return a.onPaginateChange(m)}),t.qZA()()),2&e){const i=t.MAs(13);t.xp6(15),t.Q6J("ngForOf",a.columnShowHideList),t.xp6(1),t.Q6J("matMenuTriggerFor",i),t.xp6(4),t.Q6J("formGroup",a.form),t.xp6(27),t.Q6J("dataSource",a.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&a.noData),t.xp6(1),t.Q6J("pageSize",a.pageSize)("pageSizeOptions",t.DdM(9,V))}},dependencies:[O.m,c.mk,c.sg,c.O5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.sg,l.u,g.NW,d.Hw,_.VK,_.p6,P.lW,C.KE,C.hX,C.qo,Z.Nt,S.a8,S.dk,S.dn,S.n5,h.BZ,h.fO,h.as,h.w1,h.Dz,h.nj,h.ge,h.ev,h.XQ,h.Gk,x.gM,y.Rr]}),n})()},12412:(Q,v,s)=>{s.d(v,{b:()=>T});var M=s(80529),O=s(75625),g=s(70262),h=s(62843),q=s(92340),E=s(94650);let T=(()=>{class t{constructor(r){this.httpClient=r,this.url=q.N.API_BASE_URL,this.httpHeader={headers:new M.WM({"Content-Type":"application/json"})}}getOperatorEquipment(r,o,l,p,c,d){return this.httpClient.get(this.url+"/operatorEquipment/read",{params:{user:r,building:o??"",equipNumber:l??"",status:p??"",recordsPerPage:c??"",pageNo:d??""}})}createOperatorEquipment(r,o,l,p,c,d,_,P,C,Z,S,x,y){return this.httpClient.post(this.url+"/operatorEquipment/create",{user:r,EQBLDG:o,EQEQUI:l,EQTYPE:p,EQMAX:c,EQTRLR:d,EQFTYP:_,EQRAIS:P,EQLPEL:C,EQMANU:Z,EQOWN:S,EQWORK:x,EQSTAT:y}).pipe((0,O.X)(1),(0,g.K)(this.httpError))}updateOperatorEquipment(r,o,l,p,c,d,_,P,C,Z,S,x,y){return this.httpClient.put(this.url+"/operatorEquipment/update",{user:r,EQBLDG:o,EQEQUI:l,EQTYPE:p,EQMAX:c,EQTRLR:d,EQFTYP:_,EQRAIS:P,EQLPEL:C,EQMANU:Z,EQOWN:S,EQWORK:x,EQSTAT:y}).pipe((0,O.X)(1),(0,g.K)(this.httpError))}deleteOperatorEquipment(r,o,l,p){return this.httpClient.delete(this.url+`/operatorEquipment/deleteEquipment?user=${r}&building=${o}&equipment=${l}&equipmentType=${p}`)}getEquipmentTypes(){return this.httpClient.get(this.url+"/operatorEquipment/equipmentType")}getBuildings(){return this.httpClient.get(this.url+"/operatorEquipment/Building")}getOperatorEquipmentDetails(){return this.httpClient.get(this.url+"/OperatorEquipmentDetails/read/OperatorEquipmentDetails")}getOperatorEquipmentExceptions(r,o,l,p,c){return this.httpClient.get(this.url+"/operatorEquipment/readExceptions",{params:{user:r,type:o??"",building:l??"",recordsPerPage:p??"",pageNo:c??""}})}createOpEquipException(r,o,l,p,c,d,_){return this.httpClient.post(this.url+"/operatorEquipment/createException",{user:r,EWTYPE:o,EWBLDG:l,EWRULE:p,EWZONE:c,EWTTYP:d,EWSTYP:_}).pipe((0,O.X)(1),(0,g.K)(this.httpError))}UpdateOpEquipException(r,o,l,p,c,d,_){return this.httpClient.put(this.url+"/operatorEquipment/updateException",{user:r,EWTYPE:o,EWBLDG:l,EWRULE:p,EWZONE:c,EWTTYP:d,EWSTYP:_}).pipe((0,O.X)(1),(0,g.K)(this.httpError))}OpEquipExceptionDelete(r,o,l,p,c){return this.httpClient.delete(this.url+`/operatorEquipment/deleteException?user=${r}&type=${o}&building=${l}&rule=${p}&zone=${c}`)}getOEquipmentMaintQuesHeader(r,o,l,p,c,d,_,P,C){return this.httpClient.get(this.url+"/EquipmentMaintQuesHeader/read",{params:{user:r,equipnum:o??"",equiptype:l??"",operator:p??"",building:c??"",date:d??"",time:_??"",recordsPerPage:P??"",pageNo:C??""}})}getOEquipmentMaintQuesHeaderDetails(r,o,l,p){return this.httpClient.get(this.url+"/EquipmentMaintQuesHeader/details/read",{params:{user:r,transno:o??"",recordsPerPage:l??"",pageNo:p??""}})}httpError(r){let o="";return o=r.error instanceof ErrorEvent?r.error.message:`Error Code: ${r.status}\nMessage: ${r.message}`,console.log(o),(0,h._)(()=>new Error(o))}}return t.\u0275fac=function(r){return new(r||t)(E.LFG(M.eN))},t.\u0275prov=E.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},15861:(Q,v,s)=>{function M(g,h,q,E,T,t,D){try{var r=g[t](D),o=r.value}catch(l){return void q(l)}r.done?h(o):Promise.resolve(o).then(E,T)}function O(g){return function(){var h=this,q=arguments;return new Promise(function(E,T){var t=g.apply(h,q);function D(o){M(t,E,T,D,r,"next",o)}function r(o){M(t,E,T,D,r,"throw",o)}D(void 0)})}}s.d(v,{Z:()=>O})}}]);