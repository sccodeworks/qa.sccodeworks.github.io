"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[65564],{65564:(k,u,r)=>{r.r(u),r.d(u,{StartStopTimeWorkWithDockschedulerComponent:()=>E});var p=r(35226),s=r.n(p),T=r(70879),h=r(86118),f=r(48529),t=r(94650),D=r(65412),Z=r(19132),i=r(24006),U=r(72122),A=r(97392),b=r(4859),c=r(59549),g=r(44144),S=r(84385),C=r(3238),O=r(99602),n=r(73546);let E=(()=>{class l{constructor(e,o,a,m,d){this.matDialog=e,this.cd=o,this.router=a,this.fb=m,this.WorkWithDockSchedulerService=d,this.user=localStorage.getItem("userName")||"",this.completeMsg="Call DSU804R to complete",this.failuremsg="Error occured",this.DOCK_URL="/main-nav/WorkWithDockScheduler/read"}ngOnInit(){this.element=history.state,console.log("Element received via history.state:",this.element),console.log(this.element),this.form=this.fb.group({appointmentNumber:{value:this.element.DSAPPT,disabled:!0},building:{value:this.element.DSBLDG,disabled:!0},inOut:{value:this.element.DSINOU,disabled:!0},appointmentType:{value:"",disabled:!0},loadType:{value:this.element.DSLTYP,disabled:!0},scacCode:{value:this.element.DSSCAC,disabled:!0},scheduledDateTime:{value:"",disabled:!0},actualDoor:"",trailerNumber:"",sealNumberOne:"",sealNumberTwo:"",brokenSealOne:"",brokenSealTwo:"",checkInDate:"",checkInTime:"",startDate:"",startTime:"",endDate:"",endTime:"",checkOutDate:"",checkOutTime:"",expectedDuration:"",actualDuration:""}),this.loadstartstop()}ngOnDestroy(){this.startStopTimeSubscription&&this.startStopTimeSubscription.unsubscribe()}formatDate(e){if(!e)return"";const[o,a,m]=e.split("/");return`${Number(m)<50?"20"+m:"19"+m}-${o.padStart(2,"0")}-${a.padStart(2,"0")}`}formatTime(e){if(!e)return"";const a=e.trim().match(/^(\d{1,2}):(\d{2})/);return a?`${a[1].padStart(2,"0")}:${a[2]}`:""}formatDuration(e){if(null==e||""===e)return"";const o=parseFloat(e);return isNaN(o)?"":o.toFixed(2)}loadstartstop(){this.startStopTimeSubscription&&this.startStopTimeSubscription.unsubscribe(),this.startStopTimeSubscription=this.WorkWithDockSchedulerService.startstopRead(this.user,this.element.DSAPPT,10,1).subscribe(e=>{const a=JSON.parse(e[0].data[1].value).returnedData[0];this.form.patchValue({scheduledDateTime:[(a.WSAPDT??"")+" "+(a.WSAPTM??"")],appointmentType:a.WATYPD??"",startDate:this.formatDate(a.WSTRDT)??"",startTime:this.formatTime(a.WSTRTM)??"",actualDoor:a.WKLOCN??"",trailerNumber:a.DSTRAL??"",sealNumberOne:a.DSSEA1??"",brokenSealOne:a.DSBRK1??"",sealNumberTwo:a.DSSEA2??"",brokenSealTwo:a.DSBRK2??"",checkInDate:this.formatDate(a.WCDATE),checkInTime:this.formatTime(a.WCTIME),expectedDuration:this.formatDuration(a.DSDURN)??"",endDate:this.formatDate(a.WENDDT),endTime:this.formatTime(a.WENDTM),actualDuration:this.formatDuration(a.WACDUR)??"",checkOutDate:this.formatDate(a.WOUTDT),checkOutTime:this.formatTime(a.WOUTTM)})})}startstopTime(){if(this.form.invalid)return;const e=this.form.value;this.startStopTimeSubscription&&this.startStopTimeSubscription.unsubscribe(),this.startStopTimeSubscription=this.WorkWithDockSchedulerService.startstopUpdate(this.user,this.element.DSAPPT,e.startDate,e.checkInDate,e.endDate,e.checkOutDate,e.startTime,e.checkInTime,e.endTime,e.checkOutTime,e.actualDoor,e.trailerNumber,e.sealNumberOne,e.brokenSealOne,e.sealNumberTwo,e.brokenSealTwo).subscribe(o=>{const a=o[0].data.length,m=JSON.parse(o[0].data[a-1].value).returnedData.message;console.log(JSON.parse(o[0].data[a-1].value).returnedData),m.trim().toUpperCase()===this.completeMsg.trim().toUpperCase()?this.new():m.trim().toUpperCase()===f.R.updateMsg.trim().toUpperCase()?(this.successMessage(m),this.router.navigate([this.DOCK_URL],{state:{filters:this.element?.filters||history.state?.filters||{}}})):this.failureMessage(m),this.cd.detectChanges()})}new(){this.matDialog.open(h.O,{width:"1000px",maxHeight:"90vh",data:this.element,autoFocus:!1})}successMessage(e){s().fire(e,"","success")}failureMessage(e){s().fire(e,"","error")}onBack(){this.router.navigateByUrl(this.DOCK_URL)}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(D.uw),t.Y36(t.sBO),t.Y36(Z.F0),t.Y36(i.qu),t.Y36(U.A))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-start-stop-time-work-with-dockscheduler"]],standalone:!0,features:[t.jDz],decls:151,vars:1,consts:[[1,"over-Flow"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"tally-serach-form"],[1,"over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width"],["matInput","","formControlName","appointmentNumber"],["matInput","","formControlName","building"],["matInput","","formControlName","inOut",2,"text-transform","uppercase"],["matInput","","formControlName","appointmentType"],["matInput","","formControlName","loadType",2,"text-transform","uppercase"],["matInput","","formControlName","scacCode",2,"text-transform","uppercase"],["matInput","","formControlName","scheduledDateTime"],["matInput","","formControlName","actualDoor"],["matInput","","formControlName","trailerNumber"],[1,"form-group1"],["for","inputField",1,"form-heading"],[1,"form-input"],["matInput","","formControlName","sealNumberOne"],["matInput","","formControlName","sealNumberTwo"],["formControlName","brokenSealOne"],["value",""],["value","Y"],["value","N"],["formControlName","brokenSealTwo"],[1,"form-heading"],["matInput","","type","date","formControlName","checkInDate"],["matInput","","type","time","formControlName","checkInTime"],["matInput","","type","date","formControlName","startDate"],["matInput","","type","time","formControlName","startTime"],["matInput","","type","date","formControlName","endDate"],["matInput","","type","time","formControlName","endTime"],["matInput","","type","date","formControlName","checkOutDate"],["checkOutDatePicker",""],["matInput","","type","time","formControlName","checkOutTime"],["matInput","","formControlName","actualDuration"],["matInput","","formControlName","expectedDuration"],["type","submit","mat-raised-button","",1,"buttons","addButton","new-tally-form-btn",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title")(3,"button",1),t.NdJ("click",function(){return o.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6,"Maintain Load/Unload Information"),t.qZA()(),t.TgZ(7,"mat-card-content",2)(8,"form",3)(9,"div",4)(10,"div",5)(11,"mat-form-field",6)(12,"mat-label"),t._uU(13,"Appointment Number"),t.qZA(),t._UZ(14,"input",7),t.qZA(),t.TgZ(15,"mat-form-field",6)(16,"mat-label"),t._uU(17,"Building"),t.qZA(),t._UZ(18,"input",8),t.qZA(),t.TgZ(19,"mat-form-field",6)(20,"mat-label"),t._uU(21,"In/Out"),t.qZA(),t._UZ(22,"input",9),t.qZA(),t.TgZ(23,"mat-form-field",6)(24,"mat-label"),t._uU(25,"Appointment Type"),t.qZA(),t._UZ(26,"input",10),t.qZA(),t.TgZ(27,"mat-form-field",6)(28,"mat-label"),t._uU(29,"Load Type"),t.qZA(),t._UZ(30,"input",11),t.qZA(),t.TgZ(31,"mat-form-field",6)(32,"mat-label"),t._uU(33,"SCAC Code"),t.qZA(),t._UZ(34,"input",12),t.qZA(),t.TgZ(35,"mat-form-field",6)(36,"mat-label"),t._uU(37,"Scheduled Date & Time"),t.qZA(),t._UZ(38,"input",13),t.qZA(),t.TgZ(39,"mat-form-field",6)(40,"mat-label"),t._uU(41,"Door"),t.qZA(),t._UZ(42,"input",14),t.qZA(),t.TgZ(43,"mat-form-field",6)(44,"mat-label"),t._uU(45,"Trailer Number"),t.qZA(),t._UZ(46,"input",15),t.qZA(),t.TgZ(47,"div",16)(48,"label",17),t._uU(49,"Seals"),t.qZA(),t.TgZ(50,"div",18)(51,"mat-form-field",6)(52,"mat-label"),t._uU(53,"Seal Number One"),t.qZA(),t._UZ(54,"input",19),t.qZA(),t.TgZ(55,"mat-form-field",6)(56,"mat-label"),t._uU(57,"Seal Number Two"),t.qZA(),t._UZ(58,"input",20),t.qZA()()(),t._UZ(59,"br"),t.TgZ(60,"div",16)(61,"label",17),t._uU(62,"Broken Seals"),t.qZA(),t.TgZ(63,"div",18)(64,"mat-form-field",6)(65,"mat-label"),t._uU(66,"Broken Seal One"),t.qZA(),t.TgZ(67,"mat-select",21)(68,"mat-option",22),t._uU(69,"-- Select --"),t.qZA(),t.TgZ(70,"mat-option",23),t._uU(71,"Y"),t.qZA(),t.TgZ(72,"mat-option",24),t._uU(73,"N"),t.qZA()()(),t.TgZ(74,"mat-form-field",6)(75,"mat-label"),t._uU(76,"Broken Seal Two"),t.qZA(),t.TgZ(77,"mat-select",25)(78,"mat-option",22),t._uU(79,"-- Select --"),t.qZA(),t.TgZ(80,"mat-option",23),t._uU(81,"Y"),t.qZA(),t.TgZ(82,"mat-option",24),t._uU(83,"N"),t.qZA()()()()(),t._UZ(84,"br"),t.TgZ(85,"div",16)(86,"label",17),t._uU(87,"Check-In"),t.qZA(),t.TgZ(88,"label",26),t._uU(89,"Check-In"),t.qZA(),t.TgZ(90,"div",18)(91,"mat-form-field",6)(92,"mat-label"),t._uU(93,"Check-In Date"),t.qZA(),t._UZ(94,"input",27),t.qZA(),t.TgZ(95,"mat-form-field",6)(96,"mat-label"),t._uU(97,"Check-In Time"),t.qZA(),t._UZ(98,"input",28),t.qZA()()(),t._UZ(99,"br"),t.TgZ(100,"div",16)(101,"label",17),t._uU(102,"Start Time"),t.qZA(),t.TgZ(103,"div",18)(104,"mat-form-field",6)(105,"mat-label"),t._uU(106,"Start Date"),t.qZA(),t._UZ(107,"input",29),t.qZA(),t.TgZ(108,"mat-form-field",6)(109,"mat-label"),t._uU(110,"Start Time"),t.qZA(),t._UZ(111,"input",30),t.qZA()()(),t._UZ(112,"br"),t.TgZ(113,"div",16)(114,"label",17),t._uU(115,"End Time"),t.qZA(),t.TgZ(116,"div",18)(117,"mat-form-field",6)(118,"mat-label"),t._uU(119,"End Date"),t.qZA(),t._UZ(120,"input",31),t.qZA(),t.TgZ(121,"mat-form-field",6)(122,"mat-label"),t._uU(123,"End Time"),t.qZA(),t._UZ(124,"input",32),t.qZA()()(),t._UZ(125,"br"),t.TgZ(126,"div",16)(127,"label",17),t._uU(128,"Check-Out"),t.qZA(),t.TgZ(129,"div",18)(130,"mat-form-field",6)(131,"mat-label"),t._uU(132,"Check-Out Date"),t.qZA(),t._UZ(133,"input",33)(134,"mat-datepicker",null,34),t.qZA(),t.TgZ(136,"mat-form-field",6)(137,"mat-label"),t._uU(138,"Check-Out Time"),t.qZA(),t._UZ(139,"input",35),t.qZA()()(),t.TgZ(140,"mat-form-field",6)(141,"mat-label"),t._uU(142,"Actual Duration"),t.qZA(),t._UZ(143,"input",36),t.qZA(),t.TgZ(144,"mat-form-field",6)(145,"mat-label"),t._uU(146,"Expected Duration"),t.qZA(),t._UZ(147,"input",37),t.qZA()()(),t._UZ(148,"br"),t.TgZ(149,"button",38),t.NdJ("click",function(){return o.startstopTime()}),t._uU(150,"Submit"),t.qZA()()()()),2&e&&(t.xp6(8),t.Q6J("formGroup",o.form))},dependencies:[T.m,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,A.Hw,b.lW,c.KE,c.hX,g.Nt,S.gD,C.ey,O.Mq,n.a8,n.dk,n.dn,n.n5]}),l})()}}]);