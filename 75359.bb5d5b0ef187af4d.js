"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[75359],{75359:(it,d,o)=>{o.r(d),o.d(d,{TallysVerificationComponent:()=>et});var g=o(98739),c=o(7155),D=o(70879),U=o(35226),T=o.n(U),h=o(48529),t=o(94650),m=o(24006),y=o(19132),E=o(15627),C=o(36895),b=o(97392),Z=o(28255),v=o(4859),A=o(59549),M=o(44144),P=o(84385),I=o(3238),u=o(73546),O=o(10266),S=o(90455);function N(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.searchTallys())}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function R(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.searchTallys())}),t.TgZ(1,"mat-icon"),t._uU(2,"search"),t.qZA()()}}function V(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",33)(2,"div",34)(3,"span",35),t.NdJ("click",function(l){return l.stopPropagation()}),t.TgZ(4,"mat-slide-toggle",36),t.NdJ("ngModelChange",function(l){const r=t.CHM(e).$implicit;return t.KtG(r.isActive=l)})("change",function(){const s=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.toggleColumn(s))}),t._uU(5),t.qZA()()()(),t.BQk()}if(2&a){const e=n.$implicit;t.xp6(4),t.Q6J("ngModel",e.isActive),t.xp6(1),t.hij(" ",e.name," ")}}function x(a,n){1&a&&(t.TgZ(0,"button",56),t._uU(1," Search "),t.qZA())}function B(a,n){if(1&a&&(t.TgZ(0,"form",37)(1,"div",33)(2,"div",38)(3,"mat-form-field",39)(4,"mat-label"),t._uU(5,"Tally"),t.qZA(),t._UZ(6,"input",40),t.qZA(),t.TgZ(7,"mat-form-field",39)(8,"mat-label"),t._uU(9,"Carrier"),t.qZA(),t._UZ(10,"input",41),t.qZA(),t.TgZ(11,"mat-form-field",39)(12,"mat-label"),t._uU(13,"Storer"),t.qZA(),t._UZ(14,"input",42),t.qZA(),t.TgZ(15,"mat-form-field",43)(16,"mat-label"),t._uU(17,"Reference"),t.qZA(),t._UZ(18,"input",44),t.qZA(),t.TgZ(19,"mat-form-field",39)(20,"mat-label"),t._uU(21,"Appointment"),t.qZA(),t._UZ(22,"input",45),t.qZA(),t.TgZ(23,"mat-form-field",39)(24,"mat-label"),t._uU(25,"Building/Door"),t.qZA(),t._UZ(26,"input",46),t.qZA(),t.TgZ(27,"mat-form-field",39)(28,"mat-label"),t._uU(29,"Appt Date"),t.qZA(),t._UZ(30,"input",47),t.qZA(),t.TgZ(31,"mat-form-field",39)(32,"mat-label"),t._uU(33,"Trailer Number"),t.qZA(),t._UZ(34,"input",48),t.qZA(),t.TgZ(35,"mat-form-field",39),t._UZ(36,"input",49),t.qZA(),t.TgZ(37,"mat-form-field",39)(38,"mat-label"),t._uU(39,"Tally Variance"),t.qZA(),t.TgZ(40,"mat-select",50)(41,"mat-option",51),t._uU(42,"-- Select --"),t.qZA(),t.TgZ(43,"mat-option",52),t._uU(44,"Yes"),t.qZA(),t.TgZ(45,"mat-option",53),t._uU(46,"No"),t.qZA()()(),t.TgZ(47,"mat-form-field",39)(48,"mat-label"),t._uU(49,"Tally Damaged"),t.qZA(),t.TgZ(50,"mat-select",54)(51,"mat-option",51),t._uU(52,"-- Select --"),t.qZA(),t.TgZ(53,"mat-option",52),t._uU(54,"Yes"),t.qZA(),t.TgZ(55,"mat-option",53),t._uU(56,"No"),t.qZA()()()()(),t.YNc(57,x,2,0,"button",55),t.qZA()),2&a){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(57),t.Q6J("ngIf",e.searchTextDisplay)}}function L(a,n){1&a&&(t.TgZ(0,"th",57),t._uU(1,"Item "),t.qZA())}function q(a,n){if(1&a&&(t.TgZ(0,"td",58),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(e.IDITEM)}}function W(a,n){1&a&&(t.TgZ(0,"th",57),t._uU(1,"In Transit"),t.qZA())}function Y(a,n){if(1&a&&(t.TgZ(0,"td",58),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij("",e.WQINT," ")}}function K(a,n){1&a&&(t.TgZ(0,"th",57),t._uU(1,"Received"),t.qZA())}function J(a,n){if(1&a&&(t.TgZ(0,"td",58),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij("",e.WQREC," ")}}function Q(a,n){1&a&&(t.TgZ(0,"th",57),t._uU(1,"Damaged"),t.qZA())}function F(a,n){if(1&a&&(t.TgZ(0,"td",58),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(e.IDQDAM)}}function k(a,n){1&a&&(t.TgZ(0,"th",57),t._uU(1,"Variance "),t.qZA())}function w(a,n){if(1&a&&(t.TgZ(0,"td",58),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(e.WVAR)}}function z(a,n){1&a&&(t.TgZ(0,"th",57),t._uU(1," Status "),t.qZA())}function H(a,n){if(1&a&&(t.TgZ(0,"td",58),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.Oqu(e.WSTAT)}}function G(a,n){1&a&&(t.TgZ(0,"th",57),t._uU(1,"Lots"),t.qZA())}function $(a,n){if(1&a&&(t.TgZ(0,"td",58),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",e.WLOTS," ")}}function j(a,n){1&a&&t._UZ(0,"tr",59)}function X(a,n){1&a&&t._UZ(0,"tr",60)}const tt=function(){return[8,16,24]};let et=(()=>{class a{constructor(e,i,l,s,r){this.fb=e,this.router=i,this.route=l,this.IheaderService=s,this.cdr=r,this.TallyReadURL="/main-nav/tallys/read",this.isLoading=!1,this.searchTextDisplay=!1,this.user=localStorage.getItem("userName")||"",this.dataSource=new c.by,this.pageSize=8,this.totalRecords=0,this.currentFilters=null,this.pageNumber=1,this.INITIAL_PAGE=1,this.DEFAULT_PAGE_SIZE=8,this.selectedRow=[],this.editedRows=[],this.columnShowHideList=[],this.displayedColumns=["Item","InTransit","Received","Damaged","Variance","Status"]}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){const e=history.state;this.result=e[0],this.totalRecords=e[1],this.fullDetails=e[2],this.filters=e[3],this.TallysFormData=e[4],console.log("fullDetails Form tally:",this.fullDetails),this.form=this.fb.group({Tally:this.fullDetails.Tally,Carrier:(this.fullDetails.Carrier||"").trim(),storer:this.fullDetails.Storer,Reference:(this.fullDetails.Reference||"").trim(),Appointment:this.fullDetails.Appointment,BuildingDoor:this.fullDetails["Building/Door"],ApptDate:this.fullDetails["Appt Date"],TrailerNumber:this.fullDetails["Trailer Number"],TallyExist:this.fullDetails.Message,TallyVariance:"",TallyDamaged:""});const i=this.pageSize,l=this.pageNumber;this.initializeColumnProperties(),this.getTallyVerification(i,l),this.dataSource.filterPredicate=this.createFilter()}resetSearch(){this.form.patchValue({TallyVariance:"",TallyDamaged:""}),this.currentFilters=null,this.paginator.firstPage(),this.getTallyVerification(this.pageSize,this.pageNumber)}searchTallys(){this.searchTextDisplay=1!=this.searchTextDisplay}onPaginateChange(e){this.pageSize=e.pageSize,this.getTallyVerification(e.pageSize,e.pageIndex+1)}getTallyVerification(e,i){this.getAll2Subscription&&this.getAll2Subscription.unsubscribe(),this.getAll2Subscription=this.IheaderService.TallyVerification(this.user,this.fullDetails.Tally,this.filters?.WDISPL,this.filters?.WSERL,this.filters?.WSUPP,this.filters?.WLOT,e,i).subscribe(s=>{console.log(s);var r=JSON.parse(s[0].data[1]?.value);this.dataSource.data=r.returnedData,this.totalRecords=r.TotalRecords})}ngOnDestroy(){this.getAll2Subscription&&this.getAll2Subscription.unsubscribe()}toggleColumn(e){if(e.isActive)this.displayedColumns.splice(e.position>this.displayedColumns.length-1?this.displayedColumns.length-1:e.position,0,e.name);else{let i=this.displayedColumns.indexOf(e.name);i>-1&&this.displayedColumns.splice(i,1)}console.log(this.displayedColumns)}initializeColumnProperties(){this.displayedColumns.forEach((e,i)=>{"Status"!=e&&"Lots"!=e&&this.columnShowHideList.push({position:i,name:e,isActive:!0})}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Lots",isActive:!1})}createFilter(){return(e,i)=>{const l=JSON.parse(i);return Object.keys(l).every(s=>e[s].toString().toLowerCase().includes(l[s].toLowerCase()))}}onPrintAccessInvoice(){this.IheaderService.TallyVerificationPrint(this.fullDetails.Tally,this.filters.WLOT,this.filters.WSERL,this.filters.WSUPP).subscribe(f=>{console.log("Print tally verification response:",f);const p=f[0].data[f[0].data.length-1].value;p?.toUpperCase()===h.R.ReportCreateMessage.toUpperCase()?this.successMessage(p):this.failureMessage(p)})}onPostAccessInvoice(){this.IheaderService.TallyVerificationPost(this.fullDetails.Tally).subscribe({next:l=>{const r=l[0].data[l[0].data.length-1].value;console.log(r),r?.toUpperCase()===h.R.updated.toUpperCase()?this.successMessage(r):this.failureMessage(r)}})}successMessage(e){T().fire(e,"","success")}failureMessage(e){T().fire(e,"","error")}onBack(){this.router.navigate([this.TallyReadURL])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(m.qu),t.Y36(y.F0),t.Y36(y.gz),t.Y36(E.X),t.Y36(t.sBO))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-tallys-verification"]],viewQuery:function(e,i){if(1&e&&t.Gf(g.NW,5),2&e){let l;t.iGM(l=t.CRH())&&(i.paginator=l.first)}},standalone:!0,features:[t.jDz],decls:56,vars:12,consts:[["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"buttons"],["mat-button","","class","addButton",3,"click",4,"ngIf"],["mat-button","","class","addButton","matTooltip","Search tally verification",3,"click",4,"ngIf"],["mat-button","","type","reset","value","Reset","matTooltip","Reset Tally Verification",1,"addButton","buttons",3,"click"],[1,"menu-container"],["mainMenuButton","matMenu"],[1,"grid-container"],[4,"ngFor","ngForOf"],["mat-button","","matTooltip","Hide/Show Columns",1,"mat-focus-indicator","addButton","mat-button","mat-button-base","tally-toltip-btn",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],[1,"tally-serach-form"],["class","form over-Flow",3,"formGroup",4,"ngIf"],["mat-table","",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","Item"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","InTransit"],["matColumnDef","Received"],["matColumnDef","Damaged"],["matColumnDef","Variance"],["matColumnDef","Status"],["matColumnDef","Lots"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"table-summary"],[1,"form-info-message","summary-buttons"],[1,"align-right"],["mat-raised-button","","type","submit",1,"save-btn",3,"click"],["showFirstLastButtons","",1,"tally-table-pagination",3,"length","pageSizeOptions","pageSize","page"],["paginator",""],["mat-button","",1,"addButton",3,"click"],["mat-button","","matTooltip","Search tally verification",1,"addButton",3,"click"],[1,"row"],[1,"grid-item"],[3,"click"],[2,"color","blue",3,"ngModel","ngModelChange","change"],[1,"form","over-Flow",3,"formGroup"],[1,"col"],["appearance","outline",1,"full-width"],["readonly","","matInput","","formControlName","Tally"],["readonly","","matInput","","formControlName","Carrier"],["readonly","","matInput","","formControlName","storer"],["appearance","outline",1,"full-width2"],["readonly","","matInput","","formControlName","Reference"],["matInput","","readonly","","formControlName","Appointment"],["matInput","","readonly","","formControlName","BuildingDoor"],["matInput","","readonly","","formControlName","ApptDate"],["matInput","","readonly","","formControlName","TrailerNumber"],["matInput","","formControlName","TallyExist","readonly",""],["formControlName","TallyVariance"],["value",""],["value","Y"],["value","N"],["formControlName","TallyDamaged"],["class","buttons addButton tally-search-btn","mat-raised-button","","type","submit","placeholder","Search",4,"ngIf"],["mat-raised-button","","type","submit","placeholder","Search",1,"buttons","addButton","tally-search-btn"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title")(3,"button",0),t.NdJ("click",function(){return i.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6," Tally Verification "),t.qZA(),t.TgZ(7,"div",1),t.YNc(8,N,3,0,"button",2),t.YNc(9,R,3,0,"button",3),t.TgZ(10,"button",4),t.NdJ("click",function(){return i.resetSearch()}),t.TgZ(11,"mat-icon"),t._uU(12,"loop"),t.qZA()(),t.TgZ(13,"mat-menu",5,6)(15,"div",7),t.YNc(16,V,6,2,"ng-container",8),t.qZA()(),t.TgZ(17,"button",9,10)(19,"mat-icon"),t._uU(20,"visibility_off"),t.qZA()()()(),t.TgZ(21,"mat-card-content",11),t.YNc(22,B,58,2,"form",12),t.qZA(),t.TgZ(23,"table",13),t.ynx(24,14),t.YNc(25,L,2,0,"th",15),t.YNc(26,q,2,1,"td",16),t.BQk(),t.ynx(27,17),t.YNc(28,W,2,0,"th",15),t.YNc(29,Y,2,1,"td",16),t.BQk(),t.ynx(30,18),t.YNc(31,K,2,0,"th",15),t.YNc(32,J,2,1,"td",16),t.BQk(),t.ynx(33,19),t.YNc(34,Q,2,0,"th",15),t.YNc(35,F,2,1,"td",16),t.BQk(),t.ynx(36,20),t.YNc(37,k,2,0,"th",15),t.YNc(38,w,2,1,"td",16),t.BQk(),t.ynx(39,21),t.YNc(40,z,2,0,"th",15),t.YNc(41,H,2,1,"td",16),t.BQk(),t.ynx(42,22),t.YNc(43,G,2,0,"th",15),t.YNc(44,$,2,1,"td",16),t.BQk(),t.YNc(45,j,1,0,"tr",23),t.YNc(46,X,1,0,"tr",24),t.qZA(),t.TgZ(47,"div",25)(48,"div",26)(49,"div",27)(50,"button",28),t.NdJ("click",function(){return i.onPostAccessInvoice()}),t._uU(51,"Post & Print"),t.qZA(),t.TgZ(52,"button",28),t.NdJ("click",function(){return i.onPrintAccessInvoice()}),t._uU(53," Print "),t.qZA()()()(),t.TgZ(54,"mat-paginator",29,30),t.NdJ("page",function(s){return i.onPaginateChange(s)}),t.qZA()()),2&e){const l=t.MAs(14);t.xp6(8),t.Q6J("ngIf",i.searchTextDisplay),t.xp6(1),t.Q6J("ngIf",!i.searchTextDisplay),t.xp6(7),t.Q6J("ngForOf",i.columnShowHideList),t.xp6(1),t.Q6J("matMenuTriggerFor",l),t.xp6(5),t.Q6J("ngIf",i.searchTextDisplay),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(8),t.Q6J("length",i.totalRecords)("pageSizeOptions",t.DdM(11,tt))("pageSize",i.pageSize)}},dependencies:[D.m,C.sg,C.O5,m._Y,m.Fj,m.JJ,m.JL,m.On,m.sg,m.u,g.NW,b.Hw,Z.VK,Z.p6,v.lW,A.KE,A.hX,M.Nt,P.gD,I.ey,u.a8,u.dk,u.dn,u.n5,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,O.gM,S.Rr]}),a})()}}]);