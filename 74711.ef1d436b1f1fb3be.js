"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[74711,34894,26628,70096,49741],{34894:(I,T,i)=>{i.d(T,{e:()=>v});var _=i(94650),g=i(24006);let v=(()=>{class p{constructor(l,m){this.el=l,this.control=m}onInputChange(l){const m=this.el.nativeElement,y=m.value.toUpperCase();m.value=y,this.control&&this.control.control&&this.control.control.setValue(y,{emitEvent:!1})}}return p.\u0275fac=function(l){return new(l||p)(_.Y36(_.SBq),_.Y36(g.a5))},p.\u0275dir=_.lG2({type:p,selectors:[["","appUppercase",""]],hostBindings:function(l,m){1&l&&_.NdJ("input",function(t){return m.onInputChange(t)})},standalone:!0}),p})()},39505:(I,T,i)=>{i.d(T,{L:()=>U});var _=i(24006),g=i(59549),v=i(69751),p=i(68675),C=i(54004),l=i(94650),m=i(36895),y=i(47957),t=i(3238),f=i(44144);function Z(h,D){if(1&h&&(l.TgZ(0,"mat-option",4),l._uU(1),l.qZA()),2&h){const s=D.$implicit;l.Q6J("value",s),l.xp6(1),l.Oqu(s)}}let U=(()=>{class h{constructor(s){this.fb=s,this.options=[],this.value="",this.placeholder="",this.id="",this.ngControl=null,this.label="",this.appearance="outline",this.describedBy="",this.touched=!1,this.focused=!1,this.empty=!1,this.required=!1,this.disabled=!1,this.shouldLabelFloat=!1,this.formControlName="",this.errorState=!1,this.previousValue="",this.onInput=c=>{},this.onChange=c=>{},this.onTouched=()=>{},this.control=this.fb.control(""),this.stateChanges=new v.y,this.filteredOptions=this.control.valueChanges.pipe((0,p.O)(this.value),(0,C.U)(c=>this._filter(c)))}setDescribedByIds(s){}onContainerClick(s){}markAsTouched(){this.touched||(this.touched=!0,this.onTouched())}writeValue(s){null!=s&&(this.control.setValue(s),this.value=s)}registerOnChange(s){this.onChange=s}registerOnTouched(s){this.onTouched=s}setDisabledState(s){this.disabled=s}_filter(s){if(null==s||0==s.length)return this.options;const c=s.toLowerCase(),d=this.options.filter(M=>M.toLowerCase().includes(c));return!this.disabled&&1===d.length&&this.control.value!=d[0]&&s.length>=(this.previousValue?.length??0)&&this.control.setValue(d[0]),this.onChange(this.control.value),this.previousValue=this.control.value,d}}return h.\u0275fac=function(s){return new(s||h)(l.Y36(_.qu))},h.\u0275cmp=l.Xpm({type:h,selectors:[["custom-input-autocomplete"]],hostVars:1,hostBindings:function(s,c){2&s&&l.uIk("aria-describedby",c.describedBy)},inputs:{options:"options",value:"value",placeholder:"placeholder",id:"id",ngControl:"ngControl",label:"label",appearance:"appearance"},features:[l._Bn([{provide:_.JU,multi:!0,useExisting:h},{provide:g.Eo,useExisting:h}],[{provide:_.gN,useExisting:_.sg}])],decls:8,vars:9,consts:[[3,"appearance"],["matInput","",3,"id","placeholder","formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(s,c){if(1&s&&(l.TgZ(0,"mat-form-field",0)(1,"mat-label"),l._uU(2),l.qZA(),l._UZ(3,"input",1),l.TgZ(4,"mat-autocomplete",null,2),l.YNc(6,Z,2,2,"mat-option",3),l.ALo(7,"async"),l.qZA()()),2&s){const d=l.MAs(5);l.Q6J("appearance",c.appearance),l.xp6(2),l.Oqu(c.label),l.xp6(1),l.Q6J("id",c.id)("placeholder",c.placeholder)("formControl",c.control)("matAutocomplete",d),l.xp6(3),l.Q6J("ngForOf",l.lcZ(7,7,c.filteredOptions))}},dependencies:[m.sg,_.Fj,_.JJ,_.oH,y.XC,y.ZL,t.ey,g.KE,g.hX,f.Nt,m.Ov]}),h})()},74711:(I,T,i)=>{i.r(T),i.d(T,{ActivitySupplyPoolComponent:()=>it});var _=i(15861),g=i(98739),v=i(70879),p=i(7155),C=i(86385),l=i(77579),m=i(78372),y=i(71884),t=i(94650),f=i(24006),Z=i(19132),U=i(65412),h=i(11527),D=i(36895),s=i(97392),c=i(4859),d=i(59549),M=i(44144),E=i(73546),L=i(34894),x=i(39505);function W(a,r){1&a&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid date format. Use DD-MM-YYYY. "),t.qZA())}function Y(a,r){1&a&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid date format. Use DD-MM-YYYY. "),t.qZA())}function K(a,r){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Date"),t.qZA())}function w(a,r){if(1&a&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.WTDATE)}}function J(a,r){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Reference"),t.qZA())}function Q(a,r){if(1&a&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.WKREFNO)}}function F(a,r){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Wr/Bol"),t.qZA())}function z(a,r){if(1&a&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.WKDOCN)}}function q(a,r){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Description"),t.qZA())}function j(a,r){if(1&a&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.WKTDESC)}}function V(a,r){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Transaction Type"),t.qZA())}function k(a,r){if(1&a&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.WKTTYPE)}}function H(a,r){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Quantity"),t.qZA())}function $(a,r){if(1&a&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.SNQTY)}}function G(a,r){1&a&&(t.TgZ(0,"th",41),t._uU(1,"Balance"),t.qZA())}function X(a,r){if(1&a&&(t.TgZ(0,"td",42),t._uU(1),t.qZA()),2&a){const e=r.$implicit;t.xp6(1),t.Oqu(e.WBALNC)}}function tt(a,r){1&a&&t._UZ(0,"tr",43)}function et(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr",44),t.NdJ("click",function(){const u=t.CHM(e).$implicit,A=t.oxw();return t.KtG(A.rowClick(u))}),t.qZA()}}function at(a,r){1&a&&(t.TgZ(0,"div",45),t._UZ(1,"img",46),t.TgZ(2,"h3",47),t._uU(3,"No Data Available"),t.qZA(),t.TgZ(4,"p",48),t._uU(5," There\u2019s no data to display right now. Try adjusting your filters or check back later. "),t.qZA()())}const ot=function(){return[8,16,24]};let it=(()=>{class a{constructor(e,n,o,u){this.fb=e,this.router=n,this.matDialog=o,this.supplyPoolSvc=u,this.displayedColumns=["Date","Reference","WrBol","Description","TransType","Quantity","Balance"],this.searchTextDisplay=!1,this.dataSource=new p.by,this.duplicateSource=[],this.editedRows=[],this.columnShowHideList=[],this.user=localStorage.getItem("userName")||"",this.pageSize=8,this.totalRecords=0,this.currentFilters=null,this.pageNumber=1,this.includeOptions=["I","O","A"],this.url="/main-nav/supplyPool/read",this.searchInput$=new l.x,this.isSearchMode=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.isLoading=!0,this.noData=!1,this.date=new Date,this.firstDay=new Date(this.date.getFullYear(),this.date.getMonth(),1),this.statusValue="AC"}ngOnInit(){const e=(new Date).toISOString().split("T")[0];this.element=history.state;const n=this.pageSize;this.editedRows=[];const o=this.pageNumber;this.form=this.fb.group({supplyType:this.element.S3TYPE,pool:this.element.WKNAME,startDate:this.firstDay.toLocaleDateString("fr-CA"),endDate:e,status:this.statusValue,includeType1:"",includeType2:"",includeType3:""}),this.getActivity(n,o),this.dataSource.filterPredicate=this.createFilter(),this.searchInput$.pipe((0,m.b)(500),(0,y.x)()).subscribe(u=>{this.handleSearch(u)})}getActivity(e,n){this.isLoading=!0,this.noData=!1,this.dataSource=new p.by([]);var o=this.form.value;this.poolSubscription&&this.poolSubscription.unsubscribe(),this.poolSubscription=this.supplyPoolSvc.getSupplyPoolActivity(this.user,this.element.S3TYPE,this.element.S3STOR,this.element.S3SSFX,this.element.S3CONS,this.element.S3CARR,o.startDate,o.endDate,o.includeType1,o.includeType2,o.includeType3,e,n).subscribe({next:u=>{this.isLoading=!1;const P=JSON.parse(u?.[0]?.data?.[1]?.value||"{}"),O=P?.returnedData||[];this.totalRecords=P?.TotalRecords||0,this.dataSource.data=O,this.noData=0===O.length,this.paginator&&(this.paginator.length=this.totalRecords)},error:()=>this.handleReceivableNoData()})}handleReceivableNoData(){this.isLoading=!1,this.noData=!0,this.totalRecords=0,this.allData=[],this.filteredData=[],this.pageData=[],this.dataSource=new p.by([])}getActivityBySearch(e){const n=this.pageSize;this.currentFilters=e,this.paginator.firstPage(),this.getActivity(n,this.pageNumber)}applyGlobalFilterInput(e){this.searchInput$.next(e)}handleSearch(e){if(!(e=e.trim().toLowerCase()))return this.isSearchMode=!1,this.allData=[],this.filteredData=[],void this.getActivity(this.pageSize,1);this.isSearchMode=!0,this.loadSearchChunks(e,()=>{if(0===this.filteredData.length)return this.noData=!0,void(this.dataSource.data=[]);this.noData=!1,this.loadPage(1)})}applyManualFilter(e){this.filteredData=this.allData.filter(n=>Object.values(n).some(o=>String(o).toLowerCase().includes(e))),this.noData=0===this.filteredData.length,this.totalRecords=this.filteredData.length,this.noData?this.dataSource.data=[]:this.loadPage(1)}loadPage(e){const n=(e-1)*this.pageSize;this.pageData=this.filteredData.slice(n,n+this.pageSize),this.dataSource.data=this.pageData,this.paginator&&(this.paginator.pageIndex=e-1,this.paginator.length=this.totalRecords,this.paginator.pageSize=this.pageSize)}getSearchStrategy(e){return e<=1500?{chunkSize:300,maxCalls:4}:e<=1e4?{chunkSize:2e3,maxCalls:5}:{chunkSize:5e3,maxCalls:5}}loadSearchChunks(e,n){var o=this;return(0,_.Z)(function*(){const u=o.currentFilters||{},{startDate:A="",endDate:P="",includeType1:O="",includeType2:nt="",includeType3:lt=""}=u,{chunkSize:B,maxCalls:st}=o.getSearchStrategy(o.totalRecords||0);let R=1,b=0,S=[];for(;b<st;){const rt=(yield o.supplyPoolSvc.getSupplyPoolActivity(o.user,o.element.S3TYPE,o.element.S3STOR,o.element.S3SSFX,o.element.S3CONS,o.element.S3CARR,A,P,O,nt,lt,B,R).toPromise())?.[0]?.data?.[1]?.value,N=JSON.parse(rt)?.returnedData||[],pt=N.filter(ut=>Object.values(ut).some(ct=>String(ct).toLowerCase().includes(e)));if(S.push(...pt),S.length>0||N.length<B)break;R++,b++}o.allData=S,o.filteredData=S,o.totalRecords=S.length,n?.()})()}resetSearch(){this.form.reset(),this.currentFilters=null,this.isSearchMode=!1,this.allData=[],this.filteredData=[],this.paginator.firstPage(),this.getActivity(this.pageSize,1)}createFilter(){return(e,n)=>{const o=JSON.parse(n);return Object.keys(o).every(u=>e[u].toString().toLowerCase().includes(o[u].toLowerCase()))}}onPaginateChange(e){this.pageSize=e.pageSize,this.isSearchMode?this.loadPage(e.pageIndex+1):this.getActivity(e.pageSize,e.pageIndex+1)}ngOnDestroy(){this.poolSubscription&&this.poolSubscription.unsubscribe()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}rowClick(e){this.selectedRow=e}searchSupplyPool(){this.searchTextDisplay=1!=this.searchTextDisplay}onBack(){this.router.navigate([this.url])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(f.qu),t.Y36(Z.F0),t.Y36(U.uw),t.Y36(h.x))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-activity-supply-pool"]],viewQuery:function(e,n){if(1&e&&t.Gf(g.NW,5),2&e){let o;t.iGM(o=t.CRH())&&(n.paginator=o.first)}},standalone:!0,features:[t.jDz],decls:80,vars:14,consts:[[1,"over-Flow"],[1,"title"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"header-buttons"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Search",3,"input"],[1,"tally-serach-form"],[1,"form","over-Flow",3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width"],["readonly","","matInput","","formControlName","supplyType","appUppercase",""],[1,"form-group1"],["for","inputField",1,"form-heading"],[1,"form-input"],["type","date","matInput","","formControlName","startDate"],[4,"ngIf"],["type","date","matInput","","formControlName","endDate"],["readonly","","matInput","","formControlName","pool"],["readonly","","matInput","","formControlName","status"],["appearance","outline","formControlName","includeType1","label","Include Type1",1,"full-width",3,"options"],["appearance","outline","formControlName","includeType2","label","Include Type2",1,"full-width",3,"options"],["appearance","outline","formControlName","includeType3","label","Include Type3",1,"full-width",3,"options"],[1,"footer"],["mat-raised-button","","type","submit","placeholder","Search",1,"buttons","addButton","new-tally-form-btn"],["id","myTable","mat-table","",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","Date"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Reference"],["matColumnDef","WrBol"],["matColumnDef","Description"],["matColumnDef","TransType"],["matColumnDef","Quantity"],["matColumnDef","Balance"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["class","no-data-container",4,"ngIf"],["showFirstLastButtons","",1,"tally-table-pagination",3,"length","pageSizeOptions","pageSize","page"],["paginator",""],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click"],[1,"no-data-container"],["src","assets/svg/table-icons/file.svg",1,"mat-table-icon"],[1,"no-data-title"],[1,"no-data-message"]],template:function(e,n){if(1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"button",2),t.NdJ("click",function(){return n.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6,"Supply Activity Inquiry"),t.qZA(),t.TgZ(7,"div",3)(8,"mat-form-field",4)(9,"mat-icon",5),t._uU(10,"search"),t.qZA(),t.TgZ(11,"input",6),t.NdJ("input",function(u){return n.applyGlobalFilterInput(u.target.value)}),t.qZA()()()(),t.TgZ(12,"mat-card-content",7)(13,"form",8),t.NdJ("ngSubmit",function(){return n.getActivityBySearch(n.form.value)}),t.TgZ(14,"div",9)(15,"div",10)(16,"mat-form-field",11)(17,"mat-label"),t._uU(18,"Supply Type"),t.qZA(),t._UZ(19,"input",12),t.qZA(),t.TgZ(20,"div",13)(21,"label",14),t._uU(22,"Date"),t.qZA(),t.TgZ(23,"div",15)(24,"mat-form-field",11)(25,"mat-label"),t._uU(26,"Start Date"),t.qZA(),t._UZ(27,"input",16),t.YNc(28,W,2,0,"mat-error",17),t.qZA(),t.TgZ(29,"mat-form-field",11)(30,"mat-label"),t._uU(31,"End Date"),t.qZA(),t._UZ(32,"input",18),t.YNc(33,Y,2,0,"mat-error",17),t.qZA()()(),t._UZ(34,"br"),t.TgZ(35,"mat-form-field",11)(36,"mat-label"),t._uU(37,"Pool"),t.qZA(),t._UZ(38,"input",19),t.qZA(),t.TgZ(39,"mat-form-field",11)(40,"mat-label"),t._uU(41,"Status "),t.qZA(),t._UZ(42,"input",20),t.qZA(),t.TgZ(43,"div",13)(44,"label",14),t._uU(45,"Include Types"),t.qZA(),t.TgZ(46,"div",15),t._UZ(47,"custom-input-autocomplete",21)(48,"custom-input-autocomplete",22)(49,"custom-input-autocomplete",23),t.qZA()()()(),t.TgZ(50,"div",24)(51,"button",25),t._uU(52," Search "),t.qZA()()()(),t.TgZ(53,"table",26),t.ynx(54,27),t.YNc(55,K,2,0,"th",28),t.YNc(56,w,2,1,"td",29),t.BQk(),t.ynx(57,30),t.YNc(58,J,2,0,"th",28),t.YNc(59,Q,2,1,"td",29),t.BQk(),t.ynx(60,31),t.YNc(61,F,2,0,"th",28),t.YNc(62,z,2,1,"td",29),t.BQk(),t.ynx(63,32),t.YNc(64,q,2,0,"th",28),t.YNc(65,j,2,1,"td",29),t.BQk(),t.ynx(66,33),t.YNc(67,V,2,0,"th",28),t.YNc(68,k,2,1,"td",29),t.BQk(),t.ynx(69,34),t.YNc(70,H,2,0,"th",28),t.YNc(71,$,2,1,"td",29),t.BQk(),t.ynx(72,35),t.YNc(73,G,2,0,"th",28),t.YNc(74,X,2,1,"td",29),t.BQk(),t.YNc(75,tt,1,0,"tr",36),t.YNc(76,et,1,0,"tr",37),t.qZA(),t.YNc(77,at,6,0,"div",38),t.TgZ(78,"mat-paginator",39,40),t.NdJ("page",function(u){return n.onPaginateChange(u)}),t.qZA()()),2&e){let o,u;t.xp6(13),t.Q6J("formGroup",n.form),t.xp6(15),t.Q6J("ngIf",null==(o=n.form.get("startDate"))?null:o.hasError("invalidDate")),t.xp6(5),t.Q6J("ngIf",null==(u=n.form.get("endDate"))?null:u.hasError("invalidDate")),t.xp6(14),t.Q6J("options",n.includeOptions),t.xp6(1),t.Q6J("options",n.includeOptions),t.xp6(1),t.Q6J("options",n.includeOptions),t.xp6(4),t.Q6J("dataSource",n.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("ngIf",!n.isLoading&&n.noData),t.xp6(1),t.Q6J("length",n.totalRecords)("pageSizeOptions",t.DdM(13,ot))("pageSize",n.pageSize)}},dependencies:[v.m,D.O5,f._Y,f.Fj,f.JJ,f.JL,f.sg,f.u,g.NW,s.Hw,c.lW,d.TO,d.KE,d.hX,d.qo,M.Nt,E.a8,E.dk,E.dn,E.n5,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,L.e,C.j,x.L]}),a})()}}]);