"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[96816],{96816:(Z,T,o)=>{o.r(T),o.d(T,{TallyStagingInquiryComponent:()=>$});var S=o(15861),s=o(7155),c=o(70879),p=o(77579),f=o(78372),d=o(71884),t=o(94650),_=o(19132),h=o(15627),m=o(65412),r=o(24006),D=o(36895),A=o(98739),O=o(97392),E=o(28255),U=o(4859),I=o(59549),R=o(44144),C=o(73546),L=o(10266),x=o(90455);const q=["paginator"];function N(e,l){if(1&e){const a=t.EpF();t.ynx(0),t.TgZ(1,"div",16)(2,"div",35)(3,"span",36),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(4,"mat-slide-toggle",37),t.NdJ("ngModelChange",function(i){const u=t.CHM(a).$implicit;return t.KtG(u.isActive=i)})("change",function(){const g=t.CHM(a).$implicit,u=t.oxw();return t.KtG(u.toggleColumn(g))}),t._uU(5),t.qZA()()()(),t.BQk()}if(2&e){const a=l.$implicit;t.xp6(4),t.Q6J("ngModel",a.isActive),t.xp6(1),t.hij(" ",a.name," ")}}function b(e,l){1&e&&(t.TgZ(0,"th",38),t._uU(1,"Item"),t.qZA())}function w(e,l){if(1&e&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&e){const a=l.$implicit;t.xp6(1),t.Oqu(a.IDIITM)}}function B(e,l){1&e&&(t.TgZ(0,"th",38),t._uU(1,"Status"),t.qZA())}function z(e,l){if(1&e&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&e){const a=l.$implicit;t.xp6(1),t.hij(" ",a.IDISTS," ")}}function K(e,l){1&e&&(t.TgZ(0,"th",38),t._uU(1,"Quantity"),t.qZA())}function Y(e,l){if(1&e&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&e){const a=l.$implicit;t.xp6(1),t.hij(" ",a.IDIQTY," ")}}function W(e,l){1&e&&(t.TgZ(0,"th",38),t._uU(1,"Putaway"),t.qZA())}function Q(e,l){if(1&e&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&e){const a=l.$implicit;t.xp6(1),t.hij(" ",a.IDIPUT," ")}}function H(e,l){1&e&&(t.TgZ(0,"th",38),t._uU(1,"Serial"),t.qZA())}function J(e,l){if(1&e&&(t.TgZ(0,"td",39),t._uU(1),t.qZA()),2&e){const a=l.$implicit;t.xp6(1),t.hij(" ",a.IDISRL," ")}}function k(e,l){1&e&&t._UZ(0,"tr",40)}function F(e,l){1&e&&t._UZ(0,"tr",41)}function j(e,l){1&e&&(t.TgZ(0,"div",42),t._UZ(1,"img",43),t.TgZ(2,"h3",44),t._uU(3,"No Data Available"),t.qZA(),t.TgZ(4,"p",45),t._uU(5," There\u2019s no data to display right now. Try adjusting your filters or check back later. "),t.qZA()())}const G=function(){return[8,16,24]};let $=(()=>{class e{constructor(a,n,i,g,u){this.activeRouter=a,this.IheaderService=n,this.router=i,this.matDialog=g,this.fb=u,this.displayedColumns=["Item","Status","Quantity"],this.dataSource=new s.by,this.columnShowHideList=[],this.pageSize=8,this.totalRecords=0,this.pageNumber=1,this.searchInput$=new p.x,this.isSearchMode=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.isLoading=!0,this.noData=!1,this.user=localStorage.getItem("userName")||"",this.url="/main-nav/tallys/read"}toggleColumn(a){if(a.isActive)a.position>this.displayedColumns.length-1?this.displayedColumns.push(a.name):this.displayedColumns.splice(a.position,0,a.name);else{let n=this.displayedColumns.indexOf(a.name);n>-1&&this.displayedColumns.splice(n,1)}}ngOnInit(){this.element=history.state,this.form=this.fb.group({Tally:this.element.IHTALY,Status:this.element.IHRCPS}),this.initializeColumnProperties(),this.editedRows=[];const a=this.pageSize,n=this.pageNumber;this.searchInput$.pipe((0,f.b)(500),(0,d.x)()).subscribe(i=>{this.handleSearch(i)}),this.tallyStagingInquiry(a,n)}initializeColumnProperties(){this.displayedColumns.forEach((a,n)=>{"Actions"!=a&&this.columnShowHideList.push({position:n,name:a,isActive:!0})}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Putaway",isActive:!1}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Serial",isActive:!1})}tallyStagingInquiry(a,n){this.isLoading=!0,this.noData=!1,this.dataSource=new s.by([]),this.pageSize=a||this.pageSize,this.pageNumber=n||this.pageNumber,this.IheaderService.NonLP(this.user,this.element.IHTALY,a,n).subscribe({next:i=>{this.isLoading=!1;var g=JSON.parse(i[0].data[1]?.value||"{}"),u=g.returnedData||[];this.allData=u,this.filteredData=[...u],this.totalRecords=g.TotalRecords||u.length,this.noData=0===u.length,this.dataSource.data=u,this.paginator&&(this.dataSource.paginator=this.paginator,this.paginator.length=this.totalRecords,this.paginator.pageIndex=(this.pageNumber||1)-1,this.paginator.pageSize=this.pageSize),this.noData?this.dataSource.data=[]:this.loadPage(this.pageNumber||1)},error:()=>this.handleTallyStagingNoData()})}onPaginateChange(a){this.pageSize=a.pageSize,this.isSearchMode?this.loadPage(a.pageIndex+1):this.tallyStagingInquiry(a.pageSize,a.pageIndex+1)}ngOnDestroy(){this.searchInput$.complete()}applyGlobalFilterInput(a){this.searchInput$.next(a)}handleSearch(a){if(!(a=a.trim().toLowerCase()))return this.isSearchMode=!1,this.allData=[],this.filteredData=[],void this.tallyStagingInquiry(this.pageSize,1);this.isSearchMode=!0,this.loadSearchChunks(a,()=>{if(0===this.filteredData.length)return this.noData=!0,void(this.dataSource.data=[]);this.noData=!1,this.loadPage(1)})}applyManualFilter(a){this.filteredData=this.allData.filter(n=>Object.values(n).some(i=>String(i).toLowerCase().includes(a))),this.noData=0===this.filteredData.length,this.totalRecords=this.filteredData.length,this.noData?this.dataSource.data=[]:this.loadPage(1)}loadPage(a){const n=(a-1)*this.pageSize;this.pageData=this.filteredData.slice(n,n+this.pageSize),this.dataSource.data=this.pageData,this.paginator&&(this.paginator.pageIndex=a-1,this.paginator.length=this.totalRecords,this.paginator.pageSize=this.pageSize)}getSearchStrategy(a){return a<=1500?{chunkSize:300,maxCalls:4}:a<=1e4?{chunkSize:2e3,maxCalls:5}:{chunkSize:5e3,maxCalls:5}}loadSearchChunks(a,n){var i=this;return(0,S.Z)(function*(){const{chunkSize:g,maxCalls:u}=i.getSearchStrategy(i.totalRecords||0);let M=1,v=0,y=[];for(;v<u;){const X=yield i.IheaderService.NonLP(i.user,i.element.IHTALY,g,M).toPromise(),P=JSON.parse(X[0].data[1]?.value||"{}")?.returnedData||[],V=P.filter(tt=>Object.values(tt).some(at=>String(at).toLowerCase().includes(a)));if(y.push(...V),y.length>0||P.length<g)break;M++,v++}i.allData=y,i.filteredData=y,i.totalRecords=y.length,n?.()})()}handleTallyStagingNoData(){this.isLoading=!1,this.noData=!0,this.totalRecords=0,this.allData=[],this.filteredData=[],this.pageData=[],this.dataSource=new s.by([])}onBack(){this.router.navigate([this.url])}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(_.gz),t.Y36(h.X),t.Y36(_.F0),t.Y36(m.uw),t.Y36(r.qu))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-tally-staging-inquiry"]],viewQuery:function(a,n){if(1&a&&t.Gf(q,5),2&a){let i;t.iGM(i=t.CRH())&&(n.paginator=i.first)}},standalone:!0,features:[t.jDz],decls:52,vars:11,consts:[[1,"over-Flow"],[1,"title"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"header-buttons"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Search",3,"input"],[1,"menu-container"],["mainMenuButton","matMenu"],[1,"grid-container"],[4,"ngFor","ngForOf"],["mat-button","","matTooltip","Hide/Show Columns",1,"mat-focus-indicator","addButton","mat-button","mat-button-base","tally-toltip-btn",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["src","assets/svg/header/showandhide.svg"],[1,"tally-serach-form"],[1,"form","over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width2"],["readonly","","matInput","","formControlName","Tally"],["appearance","outline",1,"full-width"],["readonly","","matInput","","formControlName","Status"],["mat-table","","id","myTable",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","Item"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Status"],["matColumnDef","Quantity"],["matColumnDef","Putaway"],["matColumnDef","Serial"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data-container",4,"ngIf"],["showFirstLastButtons","",1,"tally-table-pagination",3,"length","pageSizeOptions","pageSize","page"],["paginator",""],[1,"grid-item"],[3,"click"],[3,"ngModel","ngModelChange","change"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"no-data-container"],["src","assets/svg/table-icons/file.svg",1,"mat-table-icon"],[1,"no-data-title"],[1,"no-data-message"]],template:function(a,n){if(1&a&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"button",2),t.NdJ("click",function(){return n.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6," Inbound Staging Inquiry"),t.qZA(),t.TgZ(7,"div",3)(8,"mat-form-field",4)(9,"mat-icon",5),t._uU(10,"search"),t.qZA(),t.TgZ(11,"input",6),t.NdJ("input",function(g){return n.applyGlobalFilterInput(g.target.value)}),t.qZA()(),t.TgZ(12,"mat-menu",7,8)(14,"div",9),t.YNc(15,N,6,2,"ng-container",10),t.qZA()(),t.TgZ(16,"button",11,12),t._UZ(18,"img",13),t.qZA()()(),t.TgZ(19,"mat-card-content",14)(20,"form",15)(21,"div",16)(22,"div",17)(23,"mat-form-field",18)(24,"mat-label"),t._uU(25,"Tally"),t.qZA(),t._UZ(26,"input",19),t.qZA(),t.TgZ(27,"mat-form-field",20)(28,"mat-label"),t._uU(29,"Status"),t.qZA(),t._UZ(30,"input",21),t.qZA()()()()(),t.TgZ(31,"table",22),t.ynx(32,23),t.YNc(33,b,2,0,"th",24),t.YNc(34,w,2,1,"td",25),t.BQk(),t.ynx(35,26),t.YNc(36,B,2,0,"th",24),t.YNc(37,z,2,1,"td",25),t.BQk(),t.ynx(38,27),t.YNc(39,K,2,0,"th",24),t.YNc(40,Y,2,1,"td",25),t.BQk(),t.ynx(41,28),t.YNc(42,W,2,0,"th",24),t.YNc(43,Q,2,1,"td",25),t.BQk(),t.ynx(44,29),t.YNc(45,H,2,0,"th",24),t.YNc(46,J,2,1,"td",25),t.BQk(),t.YNc(47,k,1,0,"tr",30),t.YNc(48,F,1,0,"tr",31),t.qZA(),t.YNc(49,j,6,0,"div",32),t.TgZ(50,"mat-paginator",33,34),t.NdJ("page",function(g){return n.onPaginateChange(g)}),t.qZA()()),2&a){const i=t.MAs(13);t.xp6(15),t.Q6J("ngForOf",n.columnShowHideList),t.xp6(1),t.Q6J("matMenuTriggerFor",i),t.xp6(4),t.Q6J("formGroup",n.form),t.xp6(11),t.Q6J("dataSource",n.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("ngIf",!n.isLoading&&n.noData),t.xp6(1),t.Q6J("length",n.totalRecords)("pageSizeOptions",t.DdM(10,G))("pageSize",n.pageSize)}},dependencies:[c.m,D.sg,D.O5,r._Y,r.Fj,r.JJ,r.JL,r.On,r.sg,r.u,A.NW,O.Hw,E.VK,E.p6,U.lW,I.KE,I.hX,I.qo,R.Nt,C.a8,C.dk,C.dn,C.n5,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,L.gM,x.Rr]}),e})()},15861:(Z,T,o)=>{function S(c,p,f,d,t,_,h){try{var m=c[_](h),r=m.value}catch(D){return void f(D)}m.done?p(r):Promise.resolve(r).then(d,t)}function s(c){return function(){var p=this,f=arguments;return new Promise(function(d,t){var _=c.apply(p,f);function h(r){S(_,d,t,h,m,"next",r)}function m(r){S(_,d,t,h,m,"throw",r)}h(void 0)})}}o.d(T,{Z:()=>s})}}]);