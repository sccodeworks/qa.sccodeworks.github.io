"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[45921],{45921:(B,P,r)=>{r.r(P),r.d(P,{DetailsOperatorEquipmentComponent:()=>tt});var v=r(15861),T=r(70879),D=r(98739),h=r(7155),N=r(77579),Z=r(78372),U=r(71884),t=r(94650),R=r(80529),s=r(65412),l=r(19132),o=r(24006),u=r(12412),m=r(36895),d=r(97392),_=r(28255),C=r(4859),E=r(59549),S=r(44144),f=r(73546),M=r(10266),q=r(90455);function L(n,p){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16)(2,"div",42)(3,"span",43),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(4,"mat-slide-toggle",44),t.NdJ("ngModelChange",function(i){const g=t.CHM(e).$implicit;return t.KtG(g.isActive=i)})("change",function(){const c=t.CHM(e).$implicit,g=t.oxw();return t.KtG(g.toggleColumn(c))}),t._uU(5),t.qZA()()()(),t.BQk()}if(2&n){const e=p.$implicit;t.xp6(4),t.Q6J("ngModel",e.isActive),t.xp6(1),t.hij(" ",e.name," ")}}function w(n,p){1&n&&(t.TgZ(0,"th",45),t._uU(1,"Question Sentence"),t.qZA())}function W(n,p){if(1&n&&(t.TgZ(0,"td",46),t._uU(1),t.qZA()),2&n){const e=p.$implicit;t.xp6(1),t.Oqu(e["QDSEQ#"])}}function K(n,p){1&n&&(t.TgZ(0,"th",47),t._uU(1,"Question"),t.qZA())}function H(n,p){if(1&n&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&n){const e=p.$implicit;t.xp6(1),t.Oqu(e.QDQUES)}}function z(n,p){1&n&&(t.TgZ(0,"th",47),t._uU(1,"Equipment Check"),t.qZA())}function F(n,p){if(1&n&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&n){const e=p.$implicit;t.xp6(1),t.Oqu(e.QDANSW)}}function $(n,p){1&n&&(t.TgZ(0,"th",49),t._uU(1,"Status"),t.qZA())}function J(n,p){if(1&n&&(t.TgZ(0,"td",50)(1,"span",51),t._uU(2),t.qZA()()),2&n){const e=p.$implicit,a=t.oxw();t.xp6(1),t.Q6J("ngClass",a.getStatusClass(e.QDSTAT)),t.xp6(1),t.hij(" ",e.QDSTAT,"")}}function Y(n,p){1&n&&(t.TgZ(0,"th",47),t._uU(1,"Notes"),t.qZA())}function j(n,p){if(1&n&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&n){const e=p.$implicit;t.xp6(1),t.Oqu(e.QDNOTE)}}function k(n,p){1&n&&t._UZ(0,"tr",52)}function G(n,p){1&n&&t._UZ(0,"tr",53)}function X(n,p){1&n&&(t.TgZ(0,"div",54),t._UZ(1,"img",55),t.TgZ(2,"h3",56),t._uU(3,"No Data Available"),t.qZA(),t.TgZ(4,"p",57),t._uU(5," There\u2019s no data to display right now. Try adjusting your filters or check back later. "),t.qZA()())}const V=function(){return[8,16,24]};let tt=(()=>{class n{constructor(e,a,i,c,g){this.http=e,this.matDialog=a,this.router=i,this.fb=c,this.OperatorEquipmentSvc=g,this.user=localStorage.getItem("userName")||"",this.editedRows=[],this.dataSource=new h.by,this.searchTextDisplay=!1,this.pageSize=8,this.totalRecords=0,this.currentFilters=null,this.pageNumber=1,this.searchInput$=new N.x,this.isSearchMode=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.duplicateSource=[],this.headerActions=[],this.menuItems=[],this.filteredItems=[],this.remainingItems=[],this.searchDropdownText="",this.recentSearches=[],this.filteredRecentSearches=[],this.isLoading=!0,this.noData=!1,this.displayedColumns=["QuestionSentence","Question","EquipmentCheck","Status"],this.pagenumber=1,this.columnShowHideList=[]}ngOnInit(){const e=history.state;this.parentForm=e?.data?.[2],this.trans=e?.data?.[0]?.QHTRAN,console.log(e),this.form=this.fb.group({EquipmentNumber:e.data[0].QHEQUI,OperatorID:e.data[0].QHOPER,BuildingNumber:e.data[0].QHBLDG,EquipmentType:e.data[0].QHTYPE,DateTime:`${e.data[0].QDATE} ${e.data[0].QTIME.split(".").join(":")}`,Time:e.data[0].QTIME,Notes:e.data[0].QHNOTE,Transno:e.data[0].QHTRAN}),this.initializeColumnProperties(),this.editedRows=[];const a=this.pageSize,i=this.pageNumber;this.currentFilters=this.form.value,this.getEquipmentMaintQuesDetails(a,i),this.dataSource.filterPredicate=this.createFilter(),this.searchInput$.pipe((0,Z.b)(500),(0,U.x)()).subscribe(c=>{this.handleSearch(c)})}applyGlobalFilterInput(e){this.searchInput$.next(e)}handleSearch(e){if(e=e.trim().toLowerCase(),this.currentFilters=this.form.value,!e)return this.isSearchMode=!1,this.noData=!1,this.allData=[],this.filteredData=[],this.pageData=[],this.paginator&&(this.paginator.pageIndex=0),void this.getEquipmentMaintQuesDetails(this.pageSize,1);this.isSearchMode=!0,this.loadSearchChunks(e,()=>{if(0===this.filteredData.length)return this.noData=!0,void(this.dataSource.data=[]);this.noData=!1,this.loadPage(1)})}applyManualFilter(e){this.filteredData=this.allData.filter(a=>Object.values(a).some(i=>String(i).toLowerCase().includes(e))),this.noData=0===this.filteredData.length,this.totalRecords=this.filteredData.length,this.noData?this.dataSource.data=[]:this.loadPage(1)}loadPage(e){const a=(e-1)*this.pageSize;this.pageData=this.filteredData.slice(a,a+this.pageSize),this.dataSource.data=this.pageData,this.paginator&&(this.paginator.pageIndex=e-1,this.paginator.length=this.totalRecords,this.paginator.pageSize=this.pageSize)}onPaginateChange(e){this.pageSize=e.pageSize,this.isSearchMode?this.loadPage(e.pageIndex+1):this.getEquipmentMaintQuesDetails(e.pageSize,e.pageIndex+1)}getSearchStrategy(e){return e<=1500?{chunkSize:300,maxCalls:4}:e<=1e4?{chunkSize:2e3,maxCalls:5}:{chunkSize:5e3,maxCalls:5}}loadSearchChunks(e,a){var i=this;return(0,v.Z)(function*(){const c=i.currentFilters||{},{transno:g=i.trans}=c,A=i.totalRecords>0?i.totalRecords:1e4,{chunkSize:O,maxCalls:x}=i.getSearchStrategy(A);let y=1,Q=0,I=[];for(;Q<x;){const et=(yield i.OperatorEquipmentSvc.getOEquipmentMaintQuesHeaderDetails(i.user,g,O,y).toPromise())?.[0]?.data?.[1]?.value,b=JSON.parse(et||"{}")?.returnedData||[],at=b.filter(it=>Object.values(it).some(nt=>String(nt).toLowerCase().includes(e)));if(I.push(...at),b.length<O)break;y++,Q++}i.allData=I,i.filteredData=I,i.totalRecords=I.length,a?.()})()}getStatusClass(e){return e?["C"].includes(e)?"status-gray":["W","SH","CD"].includes(e)?"status-green":["EN","I","N","RL"].includes(e)?"status-yellow":["A","PK","BL"].includes(e)?"status-purple":["PS","CM","MQ"].includes(e)?"status-blue":["EM","EP","SB","SP","EB","R","S","DL"].includes(e)?"status-red":"status-gray":""}handleItemClick(e,a){this.executeAction(e,a),this.addToRecentSearches(e)}executeAction(e,a){"function"==typeof this[e.action]?this[e.action](a):console.warn("Action not implemented:",e.action)}handleRecentClick(e,a){this.searchDropdownText=e.label,this.onSearchChange(),"function"==typeof this[e.action]&&this[e.action](a),this.addToRecentSearches(e)}addToRecentSearches(e){this.recentSearches=this.recentSearches.filter(a=>a.label!==e.label),this.recentSearches.unshift(e),this.recentSearches.length>5&&this.recentSearches.pop(),localStorage.setItem("recentSearches",JSON.stringify(this.recentSearches.map(a=>a.label))),this.filteredRecentSearches=[...this.recentSearches]}clearRecentSearches(){this.recentSearches=[],this.filteredRecentSearches=[],localStorage.removeItem("recentSearches")}onSearchChange(){const e=(this.searchDropdownText||"").toLowerCase();this.filteredItems=this.menuItems.filter(a=>a.label.toLowerCase().includes(e)),this.filteredRecentSearches=e?[]:[...this.recentSearches]}getBySearch(e){const a=this.pageSize,i=this.pageNumber;this.currentFilters=e,this.paginator&&this.paginator.firstPage(),this.getEquipmentMaintQuesDetails(a,i)}ngAfterViewInit(){this.dataSource.paginator=this.paginator}toggleColumn(e){if(e.isActive)this.displayedColumns.splice(e.position>this.displayedColumns.length-1?this.displayedColumns.length-1:e.position,0,e.name);else{let a=this.displayedColumns.indexOf(e.name);a>-1&&this.displayedColumns.splice(a,1)}console.log(this.displayedColumns)}initializeColumnProperties(){this.displayedColumns.forEach((e,a)=>{"Status"!=e&&"Notes"!=e&&this.columnShowHideList.push({position:a,name:e,isActive:!0})}),this.columnShowHideList.push({position:this.columnShowHideList.length,name:"Notes",isActive:!1})}createFilter(){return(e,a)=>{const i=JSON.parse(a);return Object.keys(i).every(c=>e[c].toString().toLowerCase().includes(i[c].toLowerCase()))}}ngOnDestroy(){this.getAll2Subscription&&this.getAll2Subscription.unsubscribe()}searchEquipmentException(){this.searchTextDisplay=1!=this.searchTextDisplay}getEquipmentMaintQuesDetails(e,a){const i=history.state,g=this.currentFilters||{},{transno:A=i.data[0].QHTRAN}=g;this.getAll2Subscription&&this.getAll2Subscription.unsubscribe(),this.getAll2Subscription=this.OperatorEquipmentSvc.getOEquipmentMaintQuesHeaderDetails(this.user,A,e,a).subscribe(O=>{console.log(O);var x=JSON.parse(O[0].data[1]?.value);this.dataSource.data=x.returnedData,this.totalRecords=x.TotalRecords})}resetSearch(){this.form.reset();const e=this.pageSize,a=this.pageNumber;this.currentFilters=null,this.paginator.firstPage(),this.getEquipmentMaintQuesDetails(e,a)}onBack(){this.router.navigateByUrl("/main-nav/EquipMaintQuesHeader/read",{state:{returnedData:[this.parentForm]}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(R.eN),t.Y36(s.uw),t.Y36(l.F0),t.Y36(o.qu),t.Y36(u.b))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-details-operator-equipment"]],viewQuery:function(e,a){if(1&e&&t.Gf(D.NW,5),2&e){let i;t.iGM(i=t.CRH())&&(a.paginator=i.first)}},standalone:!0,features:[t.jDz],decls:68,vars:10,consts:[[1,"over-Flow"],[1,"title"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"header-buttons"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Search",3,"input"],[1,"menu-container"],["mainMenuButton","matMenu"],[1,"grid-container"],[4,"ngFor","ngForOf"],["mat-button","","matTooltip","Hide/Show Columns",1,"mat-focus-indicator","addButton","mat-button","mat-button-base","tally-toltip-btn",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["src","assets/svg/header/showandhide.svg"],[1,"tally-serach-form"],[1,"form","over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width"],["matInput","","formControlName","EquipmentNumber",2,"text-transform","uppercase"],["matInput","","formControlName","OperatorID",2,"text-transform","uppercase"],["matInput","","formControlName","BuildingNumber",2,"text-transform","uppercase"],["matInput","","formControlName","EquipmentType",2,"text-transform","uppercase"],["matInput","","formControlName","DateTime",2,"text-transform","uppercase"],["matInput","","formControlName","Notes",2,"text-transform","uppercase"],["mat-table","",1,"mat-elevation-z8","tally-table",3,"dataSource"],["matColumnDef","QuestionSentence"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","Primary-row",4,"matCellDef"],["matColumnDef","Question"],["mat-header-cell","","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","EquipmentCheck"],["matColumnDef","Status"],["mat-header-cell","","class","status-cell",4,"matHeaderCellDef"],["mat-cell","","class","status-cell",4,"matCellDef"],["matColumnDef","Notes"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data-container",4,"ngIf"],["showFirstLastButtons","",3,"pageSize","pageSizeOptions","page"],["paginator",""],[1,"grid-item"],[3,"click"],[3,"ngModel","ngModelChange","change"],["mat-header-cell",""],["mat-cell","",1,"Primary-row"],["mat-header-cell","","mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"status-cell"],["mat-cell","",1,"status-cell"],[1,"status-badge",3,"ngClass"],["mat-header-row",""],["mat-row",""],[1,"no-data-container"],["src","assets/svg/table-icons/file.svg",1,"mat-table-icon"],[1,"no-data-title"],[1,"no-data-message"]],template:function(e,a){if(1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"button",2),t.NdJ("click",function(){return a.onBack()}),t.TgZ(4,"mat-icon"),t._uU(5,"navigate_before "),t.qZA()(),t._uU(6," Work With Equipment Maint Questions Detail"),t.qZA(),t.TgZ(7,"div",3)(8,"mat-form-field",4)(9,"mat-icon",5),t._uU(10,"search"),t.qZA(),t.TgZ(11,"input",6),t.NdJ("input",function(c){return a.applyGlobalFilterInput(c.target.value)}),t.qZA()(),t.TgZ(12,"mat-menu",7,8)(14,"div",9),t.YNc(15,L,6,2,"ng-container",10),t.qZA()(),t.TgZ(16,"button",11,12),t._UZ(18,"img",13),t.qZA()()(),t.TgZ(19,"mat-card-content",14)(20,"form",15)(21,"div",16)(22,"div",17)(23,"mat-form-field",18)(24,"mat-label"),t._uU(25,"Equipment Number"),t.qZA(),t._UZ(26,"input",19),t.qZA(),t.TgZ(27,"mat-form-field",18)(28,"mat-label"),t._uU(29,"Operator ID"),t.qZA(),t._UZ(30,"input",20),t.qZA(),t.TgZ(31,"mat-form-field",18)(32,"mat-label"),t._uU(33,"Building Number"),t.qZA(),t._UZ(34,"input",21),t.qZA(),t.TgZ(35,"mat-form-field",18)(36,"mat-label"),t._uU(37,"Equipment Type"),t.qZA(),t._UZ(38,"input",22),t.qZA(),t.TgZ(39,"mat-form-field",18)(40,"mat-label"),t._uU(41,"Date/Time"),t.qZA(),t._UZ(42,"input",23),t.qZA(),t.TgZ(43,"mat-form-field",18)(44,"mat-label"),t._uU(45,"Notes"),t.qZA(),t._UZ(46,"input",24),t.qZA()()()()(),t.TgZ(47,"table",25),t.ynx(48,26),t.YNc(49,w,2,0,"th",27),t.YNc(50,W,2,1,"td",28),t.BQk(),t.ynx(51,29),t.YNc(52,K,2,0,"th",30),t.YNc(53,H,2,1,"td",31),t.BQk(),t.ynx(54,32),t.YNc(55,z,2,0,"th",30),t.YNc(56,F,2,1,"td",31),t.BQk(),t.ynx(57,33),t.YNc(58,$,2,0,"th",34),t.YNc(59,J,3,2,"td",35),t.BQk(),t.ynx(60,36),t.YNc(61,Y,2,0,"th",30),t.YNc(62,j,2,1,"td",31),t.BQk(),t.YNc(63,k,1,0,"tr",37),t.YNc(64,G,1,0,"tr",38),t.qZA(),t.YNc(65,X,6,0,"div",39),t.TgZ(66,"mat-paginator",40,41),t.NdJ("page",function(c){return a.onPaginateChange(c)}),t.qZA()()),2&e){const i=t.MAs(13);t.xp6(15),t.Q6J("ngForOf",a.columnShowHideList),t.xp6(1),t.Q6J("matMenuTriggerFor",i),t.xp6(4),t.Q6J("formGroup",a.form),t.xp6(27),t.Q6J("dataSource",a.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&a.noData),t.xp6(1),t.Q6J("pageSize",a.pageSize)("pageSizeOptions",t.DdM(9,V))}},dependencies:[T.m,m.mk,m.sg,m.O5,o._Y,o.Fj,o.JJ,o.JL,o.On,o.sg,o.u,D.NW,d.Hw,_.VK,_.p6,C.lW,E.KE,E.hX,E.qo,S.Nt,f.a8,f.dk,f.dn,f.n5,h.BZ,h.fO,h.as,h.w1,h.Dz,h.nj,h.ge,h.ev,h.XQ,h.Gk,M.gM,q.Rr]}),n})()},12412:(B,P,r)=>{r.d(P,{b:()=>U});var v=r(80529),T=r(75625),D=r(70262),h=r(62843),N=r(92340),Z=r(94650);let U=(()=>{class t{constructor(s){this.httpClient=s,this.url=N.N.API_BASE_URL,this.httpHeader={headers:new v.WM({"Content-Type":"application/json"})}}getOperatorEquipment(s,l,o,u,m,d){return this.httpClient.get(this.url+"/operatorEquipment/read",{params:{user:s,building:l??"",equipNumber:o??"",status:u??"",recordsPerPage:m??"",pageNo:d??""}})}createOperatorEquipment(s,l,o,u,m,d,_,C,E,S,f,M,q){return this.httpClient.post(this.url+"/operatorEquipment/create",{user:s,EQBLDG:l,EQEQUI:o,EQTYPE:u,EQMAX:m,EQTRLR:d,EQFTYP:_,EQRAIS:C,EQLPEL:E,EQMANU:S,EQOWN:f,EQWORK:M,EQSTAT:q}).pipe((0,T.X)(1),(0,D.K)(this.httpError))}updateOperatorEquipment(s,l,o,u,m,d,_,C,E,S,f,M,q){return this.httpClient.put(this.url+"/operatorEquipment/update",{user:s,EQBLDG:l,EQEQUI:o,EQTYPE:u,EQMAX:m,EQTRLR:d,EQFTYP:_,EQRAIS:C,EQLPEL:E,EQMANU:S,EQOWN:f,EQWORK:M,EQSTAT:q}).pipe((0,T.X)(1),(0,D.K)(this.httpError))}deleteOperatorEquipment(s,l,o,u){return this.httpClient.delete(this.url+`/operatorEquipment/deleteEquipment?user=${s}&building=${l}&equipment=${o}&equipmentType=${u}`)}getEquipmentTypes(){return this.httpClient.get(this.url+"/operatorEquipment/equipmentType")}getBuildings(){return this.httpClient.get(this.url+"/operatorEquipment/Building")}getOperatorEquipmentDetails(){return this.httpClient.get(this.url+"/OperatorEquipmentDetails/read/OperatorEquipmentDetails")}getOperatorEquipmentExceptions(s,l,o,u,m){return this.httpClient.get(this.url+"/operatorEquipment/readExceptions",{params:{user:s,type:l??"",building:o??"",recordsPerPage:u??"",pageNo:m??""}})}createOpEquipException(s,l,o,u,m,d,_){return this.httpClient.post(this.url+"/operatorEquipment/createException",{user:s,EWTYPE:l,EWBLDG:o,EWRULE:u,EWZONE:m,EWTTYP:d,EWSTYP:_}).pipe((0,T.X)(1),(0,D.K)(this.httpError))}UpdateOpEquipException(s,l,o,u,m,d,_){return this.httpClient.put(this.url+"/operatorEquipment/updateException",{user:s,EWTYPE:l,EWBLDG:o,EWRULE:u,EWZONE:m,EWTTYP:d,EWSTYP:_}).pipe((0,T.X)(1),(0,D.K)(this.httpError))}OpEquipExceptionDelete(s,l,o,u,m){return this.httpClient.delete(this.url+`/operatorEquipment/deleteException?user=${s}&type=${l}&building=${o}&rule=${u}&zone=${m}`)}getOEquipmentMaintQuesHeader(s,l,o,u,m,d,_,C,E){return this.httpClient.get(this.url+"/EquipmentMaintQuesHeader/read",{params:{user:s,equipnum:l??"",equiptype:o??"",operator:u??"",building:m??"",date:d??"",time:_??"",recordsPerPage:C??"",pageNo:E??""}})}getOEquipmentMaintQuesHeaderDetails(s,l,o,u){return this.httpClient.get(this.url+"/EquipmentMaintQuesHeader/details/read",{params:{user:s,transno:l??"",recordsPerPage:o??"",pageNo:u??""}})}httpError(s){let l="";return l=s.error instanceof ErrorEvent?s.error.message:`Error Code: ${s.status}\nMessage: ${s.message}`,console.log(l),(0,h._)(()=>new Error(l))}}return t.\u0275fac=function(s){return new(s||t)(Z.LFG(v.eN))},t.\u0275prov=Z.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);