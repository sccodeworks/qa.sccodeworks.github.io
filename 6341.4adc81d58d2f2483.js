"use strict";(self.webpackChunksc_codeworks_app=self.webpackChunksc_codeworks_app||[]).push([[6341],{6341:(de,A,c)=>{c.r(A),c.d(A,{StorerAccessInvoiceEnquiryComponent:()=>fe});var S=c(98739),u=c(7155),Z=c(70879),q=c(35226),y=c.n(q),e=c(94650),C=c(19132),P=c(11240),_=c(24006),N=c(65412),I=c(36895),O=c(97392),b=c(4859),g=c(59549),M=c(44144),h=c(99602),d=c(73546),U=c(10266);function x(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.searchAccessInvInq())}),e.TgZ(1,"mat-icon"),e._uU(2,"clear"),e.qZA()()}}function R(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.searchAccessInvInq())}),e.TgZ(1,"mat-icon"),e._uU(2,"search"),e.qZA()()}}function W(t,i){if(1&t&&(e.TgZ(0,"form",28)(1,"div",29)(2,"div",30)(3,"mat-form-field",31)(4,"mat-label"),e._uU(5,"Period"),e.qZA(),e._UZ(6,"input",32),e.qZA(),e.TgZ(7,"mat-form-field",31)(8,"mat-label"),e._uU(9,"Date "),e.qZA(),e._UZ(10,"input",33)(11,"mat-datepicker-toggle",34)(12,"mat-datepicker",null,35),e.qZA(),e.TgZ(14,"mat-form-field",31)(15,"mat-label"),e._uU(16,"Time"),e.qZA(),e._UZ(17,"input",36),e.qZA(),e.TgZ(18,"div",37)(19,"label",38),e._uU(20,"Generated"),e.qZA(),e.TgZ(21,"div",39)(22,"mat-form-field",31)(23,"mat-label"),e._uU(24,"Generated Date "),e.qZA(),e._UZ(25,"input",40)(26,"mat-datepicker-toggle",34)(27,"mat-datepicker",null,41),e.qZA(),e.TgZ(29,"mat-form-field",31)(30,"mat-label"),e._uU(31,"Generated Time"),e.qZA(),e._UZ(32,"input",42),e.qZA()()(),e.TgZ(33,"mat-form-field",31)(34,"mat-label"),e._uU(35," Page Of "),e.qZA(),e._UZ(36,"input",43),e.qZA(),e.TgZ(37,"mat-form-field",31)(38,"mat-label"),e._uU(39,"Document"),e.qZA(),e._UZ(40,"input",44),e.qZA(),e.TgZ(41,"mat-form-field",45)(42,"mat-label"),e._uU(43," Storer "),e.qZA(),e._UZ(44,"input",46),e.qZA()()(),e.TgZ(45,"button",47),e._uU(46," Search "),e.qZA()()),2&t){const n=e.MAs(13),o=e.MAs(28),r=e.oxw();e.Q6J("formGroup",r.form),e.xp6(6),e.Q6J("value",r.period),e.xp6(4),e.Q6J("matDatepicker",n),e.xp6(1),e.Q6J("for",n),e.xp6(14),e.Q6J("matDatepicker",o),e.xp6(1),e.Q6J("for",o)}}function B(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Date"),e.qZA())}function Y(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.Date)}}function J(t,i){1&t&&(e.ynx(0,48),e.YNc(1,B,2,0,"th",49),e.YNc(2,Y,2,1,"td",50),e.BQk())}function Q(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Tally Order"),e.qZA())}function K(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.TallyOrder)}}function k(t,i){1&t&&(e.ynx(0,53),e.YNc(1,Q,2,0,"th",49),e.YNc(2,K,2,1,"td",50),e.BQk())}function L(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Reference No"),e.qZA())}function G(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.ReferenceNo)}}function F(t,i){1&t&&(e.ynx(0,54),e.YNc(1,L,2,0,"th",49),e.YNc(2,G,2,1,"td",50),e.BQk())}function w(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Pieces"),e.qZA())}function $(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.Pieces)}}function z(t,i){1&t&&(e.ynx(0,55),e.YNc(1,w,2,0,"th",49),e.YNc(2,$,2,1,"td",50),e.BQk())}function H(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Weight"),e.qZA())}function X(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.Weight)}}function j(t,i){1&t&&(e.ynx(0,56),e.YNc(1,H,2,0,"th",49),e.YNc(2,X,2,1,"td",50),e.BQk())}function V(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Type"),e.qZA())}function ee(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.Type)}}function te(t,i){1&t&&(e.ynx(0,57),e.YNc(1,V,2,0,"th",49),e.YNc(2,ee,2,1,"td",50),e.BQk())}function ne(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Return Payment Type"),e.qZA())}function oe(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.RtnPayTp)}}function ie(t,i){1&t&&(e.ynx(0,58),e.YNc(1,ne,2,0,"th",49),e.YNc(2,oe,2,1,"td",50),e.BQk())}function re(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Consignee"),e.qZA())}function ce(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.Consignee)}}function ae(t,i){1&t&&(e.ynx(0,59),e.YNc(1,re,2,0,"th",49),e.YNc(2,ce,2,1,"td",50),e.BQk())}function se(t,i){1&t&&(e.TgZ(0,"th",51),e._uU(1,"Min"),e.qZA())}function le(t,i){if(1&t&&(e.TgZ(0,"td",52),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.Oqu(n.Min)}}function ue(t,i){1&t&&(e.ynx(0,60),e.YNc(1,se,2,0,"th",49),e.YNc(2,le,2,1,"td",50),e.BQk())}function me(t,i){1&t&&e._UZ(0,"tr",61)}function _e(t,i){1&t&&e._UZ(0,"tr",62)}const pe=function(){return[8,16,24]};let fe=(()=>{class t{constructor(n,o,r,l,a,s){this.router=n,this.StorerServiceService=o,this.fb=r,this.route=l,this.matDialog=a,this.cdr=s,this.StorerRead="/main-nav/storer",this.dataSource=new u.by,this.pageSize=8,this.totalRecords=0,this.currentFilters=null,this.headerColumns=["Date","TallyOrder","ReferenceNo","Pieces","Weight","Type","RtnPayTp","Consignee","Min"],this.fullWidthColumns=["Date","TallyOrder","ReferenceNo","Pieces","Weight","Type","RtnPayTp","Consignee","Min"],this.displayedColumns=this.fullWidthColumns,this.WKINVN="0",this.searchTextDisplay=!1,this.user=localStorage.getItem("userName")||"",this.columnShowHideList=[],this.period="",this.totalAmountDue=0,this.total=0}ngOnInit(){this.element=history.state,this.form=this.fb.group({Period:this.element.Period,P1STOR:[this.element.STORE]+"\xa0"+[this.element.STNAME],P1SSFX:this.element.STSFX,GEND:"",INVNO:"",Date:[new Date],Time:[this.formatCurrentTime()],GENDT:"",GENTM:"",CPAG:"1",WKDOCN:"",SNAME:""}),this.getAccessInvoiceEnquiry(this.pageSize,1),this.dataSource.filterPredicate=this.createFilter()}formatCurrentTime(){const n=new Date;return`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`}createFilter(){return(n,o)=>{const r=JSON.parse(o);return Object.keys(r).every(l=>{const a=n[l]?.toString().toLowerCase()||"",s=r[l].toLowerCase();return a.includes(s)})}}resetSearch(){this.form.reset(),this.currentFilters=null,this.paginator.firstPage(),this.getAccessInvoiceEnquiry(this.pageSize,1)}onPaginateChange(n){this.pageSize=n.pageSize,this.getAccessInvoiceEnquiry(n.pageSize,n.pageIndex+1)}searchAccessInvInq(){this.searchTextDisplay=1!=this.searchTextDisplay}processData(n){this.displayedColumns=n.some(r=>r.WKP1LINE.includes("||||"))?["Date","TallyOrder","ReferenceNo","Pieces","Weight","Type","RtnPayTp","Consignee","Min"]:this.fullWidthColumns}getAccessInvoiceEnquiry(n,o){const r=this.currentFilters||{},{P1STOR:l=`${this.element.STORE}`,P1SSFX:a="",GEND:s="",WKDOCN:T=""}=r;this.getAll2Subscription&&this.getAll2Subscription.unsubscribe(),this.getAll2Subscription=this.StorerServiceService.AccessInvoiceInquiry(this.user,l,a,s,T,this.WKINVN,n,o).subscribe(E=>{try{if(E[0].data[1]?.value){const p=JSON.parse(E[0].data[1].value),v=p.returnedData,D=v.map(f=>{if(f.WKP1LINE.includes("||||")){const m=f.WKP1LINE.split("||||");return{...f,isSplit:!0,Date:m[0]?.trim(),TallyOrder:m[1]?.trim(),ReferenceNo:m[2]?.trim(),Pieces:m[3]?.trim(),Weight:`${m[4]?.trim()} ${m[5]?.trim()}`,Type:m[6]?.trim(),RtnPayTp:m[7]?.trim(),Consignee:m[8]?.trim(),Min:m[9]?.trim()}}return{...f,isSplit:!1,Date:f.WKP1LINE}});this.period=p.Period,this.total=p.WKTOTAL,this.totalAmountDue=p["Total Amount Due"],this.processData(D),this.dataSource.data=D,this.totalRecords=p.TotalRecords,this.loadGeneratedDateTime(v[0].WKGEND)}else console.warn("Received empty or null response for data."),this.dataSource.data=[],this.totalRecords=0}catch(p){console.error("Failed to parse JSON response:",p),this.dataSource.data=[],this.totalRecords=0}})}loadGeneratedDateTime(n){const o=n.replace('WKGEND":"',"").replace(/"/g,""),r="20"+o.substring(1,3),l=o.substring(3,5),a=o.substring(5,7),s=o.substring(7,9),T=o.substring(9,11);this.form.patchValue({GENDT:new Date(`${r}-${l}-${a}`),GENTM:`${s}:${T}`})}getSupplyBySearch(n){this.currentFilters=n,this.paginator.firstPage(),this.getAccessInvoiceEnquiry(this.pageSize,1)}onPrintAccessInvoice(){const o=this.element.STORE,r=this.form.get("P1SSFX")?.value;this.StorerServiceService.PrintAccessInvoice("P",o,r,"").subscribe({next:a=>{console.log("Print Access Invoice response:",a);const s=a.msg||"Submitted Successfully";"Submitted Successfully"===s?this.successMessage(s):this.failureMessage(s)},error:a=>{console.error("Print Access Invoice error:",a),this.failureMessage("Submission Failed")}})}onPostAccessInvoice(){const o=this.element.STORE,r=this.form.get("P1SSFX")?.value;this.StorerServiceService.PostAccessInvoice("U",o,r,"").subscribe({next:a=>{console.log("Post Access Invoice response:",a);const s=a.msg||"Submitted Successfully";"Submitted Successfully"===s?this.successMessage(s):this.failureMessage(s)},error:a=>{console.error("Post Access Invoice error:",a),this.failureMessage("Submission Failed")}})}successMessage(n){y().fire(n,"","success")}failureMessage(n){y().fire(n,"","error")}onBack(){this.router.navigate([this.StorerRead])}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(C.F0),e.Y36(P.h),e.Y36(_.qu),e.Y36(C.gz),e.Y36(N.uw),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-storer-access-invoice-enquiry"]],viewQuery:function(n,o){if(1&n&&e.Gf(S.NW,5),2&n){let r;e.iGM(r=e.CRH())&&(o.paginator=r.first)}},standalone:!0,features:[e.jDz],decls:41,vars:23,consts:[[1,"over-Flow"],[1,"title"],["mat-button","",1,"backButton","go-back-btn",3,"click"],[1,"buttons"],["mat-button","","class","addButton",3,"click",4,"ngIf"],["mat-button","","class","addButton","matTooltip","search AccessInvInq",3,"click",4,"ngIf"],[1,"tally-serach-form"],["class","form over-Flow",3,"formGroup",4,"ngIf"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","Date",4,"ngIf"],["matColumnDef","TallyOrder",4,"ngIf"],["matColumnDef","ReferenceNo",4,"ngIf"],["matColumnDef","Pieces",4,"ngIf"],["matColumnDef","Weight",4,"ngIf"],["matColumnDef","Type",4,"ngIf"],["matColumnDef","RtnPayTp",4,"ngIf"],["matColumnDef","Consignee",4,"ngIf"],["matColumnDef","Min",4,"ngIf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"Content-page-both"],[1,"left-side"],[1,"buttons","button3"],["mat-raised-button","","type","submit",1,"buttons","addButton","tally-search-btn",3,"click"],["showFirstLastButtons","",1,"tally-table-pagination",3,"length","pageSizeOptions","pageSize","page"],["paginator",""],["mat-button","",1,"addButton",3,"click"],["mat-button","","matTooltip","search AccessInvInq",1,"addButton",3,"click"],[1,"form","over-Flow",3,"formGroup"],[1,"row"],[1,"col"],["appearance","outline",1,"full-width"],["matInput","","readonly","",3,"value"],["matInput","","formControlName","Date",3,"matDatepicker"],["matSuffix","",3,"for"],["DatePicker",""],["matInput","","type","Time","formControlName","Time","placeholder","HH:mm","id","generatedtime","required",""],[1,"form-group1"],["for","inputField",1,"form-heading"],[1,"form-input"],["matInput","","formControlName","GENDT",3,"matDatepicker"],["GeneratedDatePicker",""],["matInput","","type","time","formControlName","GENTM","placeholder","HH:mm","id","generatedtime","required",""],["matInput","","formControlName","CPAG"],["matInput","","formControlName","WKDOCN"],["appearance","outline",1,"full-width2"],["matInput","","formControlName","P1STOR",2,"text-transform","uppercase"],["mat-raised-button","","type","submit","placeholder","Search",1,"buttons","addButton","tally-search-btn"],["matColumnDef","Date"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["matColumnDef","TallyOrder"],["matColumnDef","ReferenceNo"],["matColumnDef","Pieces"],["matColumnDef","Weight"],["matColumnDef","Type"],["matColumnDef","RtnPayTp"],["matColumnDef","Consignee"],["matColumnDef","Min"],["mat-header-row",""],["mat-row",""]],template:function(n,o){1&n&&(e.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1)(3,"button",2),e.NdJ("click",function(){return o.onBack()}),e.TgZ(4,"mat-icon"),e._uU(5,"navigate_before "),e.qZA()(),e._uU(6,"Accessorial Invoice WorkSheet Inquiry"),e.qZA(),e.TgZ(7,"div",3),e.YNc(8,x,3,0,"button",4),e.YNc(9,R,3,0,"button",5),e.qZA()(),e.TgZ(10,"mat-card-content",6),e.YNc(11,W,47,6,"form",7),e.qZA(),e.TgZ(12,"table",8),e.YNc(13,J,3,0,"ng-container",9),e.YNc(14,k,3,0,"ng-container",10),e.YNc(15,F,3,0,"ng-container",11),e.YNc(16,z,3,0,"ng-container",12),e.YNc(17,j,3,0,"ng-container",13),e.YNc(18,te,3,0,"ng-container",14),e.YNc(19,ie,3,0,"ng-container",15),e.YNc(20,ae,3,0,"ng-container",16),e.YNc(21,ue,3,0,"ng-container",17),e.YNc(22,me,1,0,"tr",18),e.YNc(23,_e,1,0,"tr",19),e.qZA(),e.TgZ(24,"div",20),e._UZ(25,"br")(26,"br"),e.TgZ(27,"div",21)(28,"button",22),e._uU(29),e.ALo(30,"number"),e.qZA()()(),e._UZ(31,"br")(32,"br"),e.TgZ(33,"div",20)(34,"div",21)(35,"button",23),e.NdJ("click",function(){return o.onPostAccessInvoice()}),e._uU(36,"Post & Print"),e.qZA(),e.TgZ(37,"button",23),e.NdJ("click",function(){return o.onPrintAccessInvoice()}),e._uU(38," Print "),e.qZA()()(),e.TgZ(39,"mat-paginator",24,25),e.NdJ("page",function(l){return o.onPaginateChange(l)}),e.qZA()()),2&n&&(e.xp6(8),e.Q6J("ngIf",o.searchTextDisplay),e.xp6(1),e.Q6J("ngIf",!o.searchTextDisplay),e.xp6(2),e.Q6J("ngIf",o.searchTextDisplay),e.xp6(1),e.Q6J("dataSource",o.dataSource),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("Date")),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("TallyOrder")),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("ReferenceNo")),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("Pieces")),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("Weight")),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("Type")),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("RtnPayTp")),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("Consignee")),e.xp6(1),e.Q6J("ngIf",o.displayedColumns.includes("Min")),e.xp6(1),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(6),e.hij(" Total Amount : $",e.xi3(30,19,o.totalAmountDue,"1.2-2")," "),e.xp6(10),e.Q6J("length",o.totalRecords)("pageSizeOptions",e.DdM(22,pe))("pageSize",o.pageSize))},dependencies:[Z.m,I.O5,_._Y,_.Fj,_.JJ,_.JL,_.Q7,_.sg,_.u,S.NW,O.Hw,b.lW,g.KE,g.hX,g.R9,M.Nt,h.Mq,h.hl,h.nW,d.a8,d.dk,d.dn,d.n5,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,U.gM,I.JJ]}),t})()}}]);